/* w2ui-fields.js 1.5.x (nightly), part of w2ui (c) http://w2ui.com, vitmalina@gmail.com */
var w2ui=w2ui||{},w2obj=w2obj||{},w2utils=function(m){var e={};return{version:"1.5.x",settings:{locale:"en-us",dateFormat:"m/d/yyyy",timeFormat:"hh:mi pm",datetimeFormat:"m/d/yyyy|hh:mi pm",currencyPrefix:"$",currencySuffix:"",currencyPrecision:2,groupSymbol:",",decimalSymbol:".",shortmonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullmonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortdays:["M","T","W","T","F","S","S"],fulldays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekStarts:"M",dataType:"HTTPJSON",phrases:{},dateStartYear:1950,dateEndYear:2030,macButtonOrder:!1},isBin:function(e){return/^[0-1]+$/.test(e)},isInt:c,isFloat:function(e){"string"==typeof e&&(e=e.replace(/\s+/g,"").replace(w2utils.settings.groupSymbol,"").replace(w2utils.settings.decimalSymbol,"."));return("number"==typeof e||"string"==typeof e&&""!==e)&&!isNaN(Number(e))},isMoney:function(e){var t=w2utils.settings,i=new RegExp("^"+(t.currencyPrefix?"\\"+t.currencyPrefix+"?":"")+"[-+]?"+(t.currencyPrefix?"\\"+t.currencyPrefix+"?":"")+"[0-9]*[\\"+t.decimalSymbol+"]?[0-9]+"+(t.currencySuffix?"\\"+t.currencySuffix+"?":"")+"$","i");"string"==typeof e&&(e=e.replace(new RegExp(t.groupSymbol,"g"),""));return"object"!=typeof e&&""!==e&&i.test(e)},isHex:function(e){return/^(0x)?[0-9a-fA-F]+$/.test(e)},isAlphaNumeric:function(e){return/^[a-zA-Z0-9_-]+$/.test(e)},isEmail:function(e){return/^[a-zA-Z0-9._%\-+]+@[а-яА-Яa-zA-Z0-9.-]+\.[а-яА-Яa-zA-Z]+$/.test(e)},isIpAddress:function(e){return new RegExp("^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$").test(e)},isDate:function(e,t,i){if(!e)return!1;var n,s,o,a="Invalid Date";null==t&&(t=w2utils.settings.dateFormat);if("function"==typeof e.getFullYear)o=e.getFullYear(),n=e.getMonth()+1,s=e.getDate();else if(parseInt(e)==e&&0<parseInt(e))e=new Date(parseInt(e)),o=e.getFullYear(),n=e.getMonth()+1,s=e.getDate();else{if(e=String(e),new RegExp("mon","ig").test(t)){t=t.replace(/month/gi,"m").replace(/mon/gi,"m").replace(/dd/gi,"d").replace(/[, ]/gi,"/").replace(/\/\//g,"/").toLowerCase(),e=e.replace(/[, ]/gi,"/").replace(/\/\//g,"/").toLowerCase();for(var r=0,l=w2utils.settings.fullmonths.length;r<l;r++){var d=w2utils.settings.fullmonths[r];e=e.replace(new RegExp(d,"ig"),parseInt(r)+1).replace(new RegExp(d.substr(0,3),"ig"),parseInt(r)+1)}}var u=e.replace(/-/g,"/").replace(/\./g,"/").toLowerCase().split("/"),t=t.replace(/-/g,"/").replace(/\./g,"/").toLowerCase();"mm/dd/yyyy"===t&&(n=u[0],s=u[1],o=u[2]),"m/d/yyyy"===t&&(n=u[0],s=u[1],o=u[2]),"dd/mm/yyyy"===t&&(n=u[1],s=u[0],o=u[2]),"d/m/yyyy"===t&&(n=u[1],s=u[0],o=u[2]),"yyyy/dd/mm"===t&&(n=u[2],s=u[1],o=u[0]),"yyyy/d/m"===t&&(n=u[2],s=u[1],o=u[0]),"yyyy/mm/dd"===t&&(n=u[1],s=u[2],o=u[0]),"yyyy/m/d"===t&&(n=u[1],s=u[2],o=u[0]),"mm/dd/yy"===t&&(n=u[0],s=u[1],o=u[2]),"m/d/yy"===t&&(n=u[0],s=u[1],o=parseInt(u[2])+1900),"dd/mm/yy"===t&&(n=u[1],s=u[0],o=parseInt(u[2])+1900),"d/m/yy"===t&&(n=u[1],s=u[0],o=parseInt(u[2])+1900),"yy/dd/mm"===t&&(n=u[2],s=u[1],o=parseInt(u[0])+1900),"yy/d/m"===t&&(n=u[2],s=u[1],o=parseInt(u[0])+1900),"yy/mm/dd"===t&&(n=u[1],s=u[2],o=parseInt(u[0])+1900),"yy/m/d"===t&&(n=u[1],s=u[2],o=parseInt(u[0])+1900)}if(!c(o))return!1;if(!c(n))return!1;if(!c(s))return!1;if(o=+o,n=+n,s=+s,(a=new Date(o,n-1,s)).setFullYear(o),null==n)return!1;if("Invalid Date"===String(a))return!1;if(a.getMonth()+1!==n||a.getDate()!==s||a.getFullYear()!==o)return!1;return!0!==i||a},isTime:function(e,t){if(null==e)return!1;e=(e=String(e)).toUpperCase(),n=0<=e.indexOf("AM");var i,n,s,o=(s=0<=e.indexOf("PM"))||n;i=o?12:24;e=e.replace("AM","").replace("PM","");var e=(e=m.trim(e)).split(":"),a=parseInt(e[0]||0),r=parseInt(e[1]||0),l=parseInt(e[2]||0);if((!o||1!==e.length)&&2!==e.length&&3!==e.length)return!1;if(""===e[0]||a<0||i<a||!this.isInt(e[0])||2<e[0].length)return!1;if(1<e.length&&(""===e[1]||r<0||59<r||!this.isInt(e[1])||2!==e[1].length))return!1;if(2<e.length&&(""===e[2]||l<0||59<l||!this.isInt(e[2])||2!==e[2].length))return!1;if(!o&&i===a&&(0!==r||0!==l))return!1;if(o&&1===e.length&&0===a)return!1;if(!0!==t)return!0;s&&12!==a&&(a+=12);n&&12===a&&(a+=12);return{hours:a,minutes:r,seconds:l}},isDateTime:function(e,t,i){if("function"==typeof e.getFullYear)return!0!==i||e;var n=parseInt(e);if(n===e)return!(n<0)&&(!0!==i||new Date(n));n=String(e).indexOf(" ");return n<0?!(String(e).indexOf("T")<0||"Invalid Date"==String(new Date(e)))&&(!0!==i||new Date(e)):(t=(t=null==t?w2utils.settings.datetimeFormat:t).split("|"),e=[e.substr(0,n),e.substr(n).trim()],t[0]=t[0].trim(),t[1]&&(t[1]=t[1].trim()),n=w2utils.isDate(e[0],t[0],!0),t=w2utils.isTime(e[1],!0),!1!==n&&!1!==t&&(!0!==i||(n.setHours(t.hours),n.setMinutes(t.minutes),n.setSeconds(t.seconds),n)))},age:function(e){if(""===e||null==e)return"";e="function"==typeof e.getFullYear?e:parseInt(e)==e&&0<parseInt(e)?new Date(parseInt(e)):new Date(e);if("Invalid Date"===String(e))return"";var e=((new Date).getTime()-e.getTime())/1e3,t="",i="";e<0?(t=0,i="sec"):e<60?(t=Math.floor(e),i="sec",e<0&&(t=0,i="sec")):e<3600?(t=Math.floor(e/60),i="min"):e<86400?(t=Math.floor(e/60/60),i="hour"):e<2592e3?(t=Math.floor(e/24/60/60),i="day"):e<31536e3?(t=Math.floor(e/30/24/60/60*10)/10,i="month"):e<126144e3?(t=Math.floor(e/365/24/60/60*10)/10,i="year"):126144e3<=e&&(t=Math.floor(e/365.25/24/60/60*10)/10,i="year");return t+" "+i+(1<t?"s":"")},interval:function(e){var t="";t=e<1e3?"< 1 sec":e<6e4?Math.floor(e/1e3)+" secs":e<36e5?Math.floor(e/6e4)+" mins":e<864e5?Math.floor(e/36e5*10)/10+" hours":e<2628e6?Math.floor(e/864e5*10)/10+" days":e<31536e6?Math.floor(e/2628e6*10)/10+" months":Math.floor(e/31536e5)/10+" years";return t},date:function(e){if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var t=new Date(e);w2utils.isInt(e)&&(t=new Date(Number(e)));if("Invalid Date"===String(t))return"";var e=w2utils.settings.shortmonths,i=new Date,n=new Date,s=(n.setTime(n.getTime()-864e5),e[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()),i=e[i.getMonth()]+" "+i.getDate()+", "+i.getFullYear(),e=e[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear(),n=t.getHours()-(12<t.getHours()?12:0)+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+" "+(12<=t.getHours()?"pm":"am"),t=t.getHours()-(12<t.getHours()?12:0)+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+" "+(12<=t.getHours()?"pm":"am"),o=s;s==i&&(o=n);s==e&&(o=w2utils.lang("Yesterday"));return'<span title="'+s+" "+t+'">'+o+"</span>"},formatSize:function(e){var t;return w2utils.isFloat(e)&&""!==e?0===(e=parseFloat(e))?0:(t=parseInt(Math.floor(Math.log(e)/Math.log(1024))),(Math.floor(e/Math.pow(1024,t)*10)/10).toFixed(0===t?0:1)+" "+(["Bt","KB","MB","GB","TB","PB","EB","ZB"][t]||"??")):""},formatNumber:function(e,t,i){if(null==e||""===e||"object"==typeof e)return"";i={minimumFractionDigits:parseInt(t),maximumFractionDigits:parseInt(t),useGrouping:!!i};(null==t||t<0)&&(i.minimumFractionDigits=0,i.maximumFractionDigits=20);return parseFloat(e).toLocaleString(w2utils.settings.locale,i)},formatDate:function(e,t){t=t||this.settings.dateFormat;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var i,n=new Date(e);w2utils.isInt(e)&&(n=new Date(Number(e)));return"Invalid Date"===String(n)?"":(e=n.getFullYear(),i=n.getMonth(),n=n.getDate(),t.toLowerCase().replace("month",w2utils.settings.fullmonths[i]).replace("mon",w2utils.settings.shortmonths[i]).replace(/yyyy/g,("000"+e).slice(-4)).replace(/yyy/g,("000"+e).slice(-4)).replace(/yy/g,("0"+e).slice(-2)).replace(/(^|[^a-z$])y/g,"$1"+e).replace(/mm/g,("0"+(i+1)).slice(-2)).replace(/dd/g,("0"+n).slice(-2)).replace(/th/g,1==n?"st":"th").replace(/th/g,2==n?"nd":"th").replace(/th/g,3==n?"rd":"th").replace(/(^|[^a-z$])m/g,"$1"+(i+1)).replace(/(^|[^a-z$])d/g,"$1"+n))},formatTime:function(e,t){w2utils.settings.shortmonths,w2utils.settings.fullmonths;t=t||this.settings.timeFormat;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var i=new Date(e);w2utils.isInt(e)&&(i=new Date(Number(e)));w2utils.isTime(e)&&(e=w2utils.isTime(e,!0),(i=new Date).setHours(e.hours),i.setMinutes(e.minutes));if("Invalid Date"===String(i))return"";var e="am",n=i.getHours(),s=i.getHours(),o=i.getMinutes(),i=i.getSeconds();o<10&&(o="0"+o);i<10&&(i="0"+i);-1===t.indexOf("am")&&-1===t.indexOf("pm")||(12<=n&&(e="pm"),12<n&&(n-=12),0===n&&(n=12));return t.toLowerCase().replace("am",e).replace("pm",e).replace("hhh",n<10?"0"+n:n).replace("hh24",s<10?"0"+s:s).replace("h24",s).replace("hh",n).replace("mm",o).replace("mi",o).replace("ss",i).replace(/(^|[^a-z$])h/g,"$1"+n).replace(/(^|[^a-z$])m/g,"$1"+o).replace(/(^|[^a-z$])s/g,"$1"+i)},formatDateTime:function(e,t){var i;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";"string"!=typeof t?i=[this.settings.dateFormat,this.settings.timeFormat]:((i=t.split("|"))[0]=i[0].trim(),i[1]=1<i.length?i[1].trim():this.settings.timeFormat);"h12"===i[1]&&(i[1]="h:m pm");"h24"===i[1]&&(i[1]="h24:m");return this.formatDate(e,i[0])+" "+this.formatTime(e,i[1])},stripTags:function(e){if(null!=e)switch(typeof e){case"number":break;case"string":e=String(e).replace(/<(?:[^>=]|='[^']*'|="[^"]*"|=[^'"][^\s>]*)*>/gi,"");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.stripTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.stripTags(e[t])}return e},encodeTags:i,decodeTags:function(e){if(null!=e)switch(typeof e){case"number":break;case"string":e=String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.decodeTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.decodeTags(e[t])}return e},escapeId:function(e){return""===e||null==e?"":String(e).replace(/([;&,\.\+\*\~'`:"\!\^#$%@\[\]\(\)=<>\|\/? {}\\])/g,"\\$1")},base64encode:function(e){var t,i,n,s,o,a,r="",l=0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=function(e){e=String(e).replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):t=127<n&&n<2048?(t+=String.fromCharCode(n>>6|192))+String.fromCharCode(63&n|128):(t=(t+=String.fromCharCode(n>>12|224))+String.fromCharCode(n>>6&63|128))+String.fromCharCode(63&n|128)}return t}(e);for(;l<e.length;)s=e.charCodeAt(l++),t=e.charCodeAt(l++),i=e.charCodeAt(l++),n=s>>2,s=(3&s)<<4|t>>4,o=(15&t)<<2|i>>6,a=63&i,isNaN(t)?o=a=64:isNaN(i)&&(a=64),r=r+d.charAt(n)+d.charAt(s)+d.charAt(o)+d.charAt(a);return r},base64decode:function(e){var t,i,n,s,o,a="",r=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;r<e.length;)i=l.indexOf(e.charAt(r++)),n=l.indexOf(e.charAt(r++)),s=l.indexOf(e.charAt(r++)),o=l.indexOf(e.charAt(r++)),i=i<<2|n>>4,n=(15&n)<<4|s>>2,t=(3&s)<<6|o,a+=String.fromCharCode(i),64!==s&&(a+=String.fromCharCode(n)),64!==o&&(a+=String.fromCharCode(t));return a=function(e){for(var t,i,n,s="",o=0;o<e.length;)(t=e.charCodeAt(o))<128?(s+=String.fromCharCode(t),o++):191<t&&t<224?(i=e.charCodeAt(o+1),s+=String.fromCharCode((31&t)<<6|63&i),o+=2):(i=e.charCodeAt(o+1),n=e.charCodeAt(o+2),s+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),o+=3);return s}(a)},md5:function(e){var o=0;function t(e){return a(r(s(e),8*e.length))}function i(e){for(var t,i=o?"0123456789ABCDEF":"0123456789abcdef",n="",s=0;s<e.length;s++)t=e.charCodeAt(s),n+=i.charAt(t>>>4&15)+i.charAt(15&t);return n}function n(e){for(var t,i,n="",s=-1;++s<e.length;)t=e.charCodeAt(s),i=s+1<e.length?e.charCodeAt(s+1):0,55296<=t&&t<=56319&&56320<=i&&i<=57343&&(t=65536+((1023&t)<<10)+(1023&i),s++),t<=127?n+=String.fromCharCode(t):t<=2047?n+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}function s(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t}function a(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function r(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,n=-271733879,s=-1732584194,o=271733878,a=0;a<e.length;a+=16){var r=i,l=n,d=s,u=o,i=c(i,n,s,o,e[a+0],7,-680876936),o=c(o,i,n,s,e[a+1],12,-389564586),s=c(s,o,i,n,e[a+2],17,606105819),n=c(n,s,o,i,e[a+3],22,-1044525330);i=c(i,n,s,o,e[a+4],7,-176418897),o=c(o,i,n,s,e[a+5],12,1200080426),s=c(s,o,i,n,e[a+6],17,-1473231341),n=c(n,s,o,i,e[a+7],22,-45705983),i=c(i,n,s,o,e[a+8],7,1770035416),o=c(o,i,n,s,e[a+9],12,-1958414417),s=c(s,o,i,n,e[a+10],17,-42063),n=c(n,s,o,i,e[a+11],22,-1990404162),i=c(i,n,s,o,e[a+12],7,1804603682),o=c(o,i,n,s,e[a+13],12,-40341101),s=c(s,o,i,n,e[a+14],17,-1502002290),i=p(i,n=c(n,s,o,i,e[a+15],22,1236535329),s,o,e[a+1],5,-165796510),o=p(o,i,n,s,e[a+6],9,-1069501632),s=p(s,o,i,n,e[a+11],14,643717713),n=p(n,s,o,i,e[a+0],20,-373897302),i=p(i,n,s,o,e[a+5],5,-701558691),o=p(o,i,n,s,e[a+10],9,38016083),s=p(s,o,i,n,e[a+15],14,-660478335),n=p(n,s,o,i,e[a+4],20,-405537848),i=p(i,n,s,o,e[a+9],5,568446438),o=p(o,i,n,s,e[a+14],9,-1019803690),s=p(s,o,i,n,e[a+3],14,-187363961),n=p(n,s,o,i,e[a+8],20,1163531501),i=p(i,n,s,o,e[a+13],5,-1444681467),o=p(o,i,n,s,e[a+2],9,-51403784),s=p(s,o,i,n,e[a+7],14,1735328473),i=h(i,n=p(n,s,o,i,e[a+12],20,-1926607734),s,o,e[a+5],4,-378558),o=h(o,i,n,s,e[a+8],11,-2022574463),s=h(s,o,i,n,e[a+11],16,1839030562),n=h(n,s,o,i,e[a+14],23,-35309556),i=h(i,n,s,o,e[a+1],4,-1530992060),o=h(o,i,n,s,e[a+4],11,1272893353),s=h(s,o,i,n,e[a+7],16,-155497632),n=h(n,s,o,i,e[a+10],23,-1094730640),i=h(i,n,s,o,e[a+13],4,681279174),o=h(o,i,n,s,e[a+0],11,-358537222),s=h(s,o,i,n,e[a+3],16,-722521979),n=h(n,s,o,i,e[a+6],23,76029189),i=h(i,n,s,o,e[a+9],4,-640364487),o=h(o,i,n,s,e[a+12],11,-421815835),s=h(s,o,i,n,e[a+15],16,530742520),i=f(i,n=h(n,s,o,i,e[a+2],23,-995338651),s,o,e[a+0],6,-198630844),o=f(o,i,n,s,e[a+7],10,1126891415),s=f(s,o,i,n,e[a+14],15,-1416354905),n=f(n,s,o,i,e[a+5],21,-57434055),i=f(i,n,s,o,e[a+12],6,1700485571),o=f(o,i,n,s,e[a+3],10,-1894986606),s=f(s,o,i,n,e[a+10],15,-1051523),n=f(n,s,o,i,e[a+1],21,-2054922799),i=f(i,n,s,o,e[a+8],6,1873313359),o=f(o,i,n,s,e[a+15],10,-30611744),s=f(s,o,i,n,e[a+6],15,-1560198380),n=f(n,s,o,i,e[a+13],21,1309151649),i=f(i,n,s,o,e[a+4],6,-145523070),o=f(o,i,n,s,e[a+11],10,-1120210379),s=f(s,o,i,n,e[a+2],15,718787259),n=f(n,s,o,i,e[a+9],21,-343485551),i=m(i,r),n=m(n,l),s=m(s,d),o=m(o,u)}return Array(i,n,s,o)}function l(e,t,i,n,s,o){return m((t=m(m(t,e),m(n,o)))<<s|t>>>32-s,i)}function c(e,t,i,n,s,o,a){return l(t&i|~t&n,e,t,s,o,a)}function p(e,t,i,n,s,o,a){return l(t&n|i&~n,e,t,s,o,a)}function h(e,t,i,n,s,o,a){return l(t^i^n,e,t,s,o,a)}function f(e,t,i,n,s,o,a){return l(i^(t|~n),e,t,s,o,a)}function m(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}return function(e){return i(t(n(e)))}(e)},transition:function(e,t,i,n){var s=m(e).width(),o=m(e).height();if(e&&t){switch(e.parentNode.style.cssText+="perspective: 900px; overflow: hidden;",e.style.cssText+="; position: absolute; z-index: 1019; backface-visibility: hidden",t.style.cssText+="; position: absolute; z-index: 1020; backface-visibility: hidden",i){case"slide-left":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d("+s+"px, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(-"+s+"px, 0, 0)"},1);break;case"slide-right":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(-"+s+"px, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0px, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d("+s+"px, 0, 0)"},1);break;case"slide-down":e.style.cssText+="overflow: hidden; z-index: 1; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; z-index: 0; transform: translate3d(0, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(0, "+o+"px, 0)"},1);break;case"slide-up":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(0, "+o+"px, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)"},1);break;case"flip-left":e.style.cssText+="overflow: hidden; transform: rotateY(0deg)",t.style.cssText+="overflow: hidden; transform: rotateY(-180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateY(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateY(180deg)"},1);break;case"flip-right":e.style.cssText+="overflow: hidden; transform: rotateY(0deg)",t.style.cssText+="overflow: hidden; transform: rotateY(180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateY(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateY(-180deg)"},1);break;case"flip-down":e.style.cssText+="overflow: hidden; transform: rotateX(0deg)",t.style.cssText+="overflow: hidden; transform: rotateX(180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateX(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateX(-180deg)"},1);break;case"flip-up":e.style.cssText+="overflow: hidden; transform: rotateX(0deg)",t.style.cssText+="overflow: hidden; transform: rotateX(-180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateX(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateX(180deg)"},1);break;case"pop-in":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); transform: scale(.8); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: scale(1); opacity: 1;",e.style.cssText+="transition: 0.5s;"},1);break;case"pop-out":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); transform: scale(1); opacity: 1;",t.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; opacity: 1;",e.style.cssText+="transition: 0.5s; transform: scale(1.7); opacity: 0;"},1);break;default:e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; translate3d(0, 0, 0); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; opacity: 1;",e.style.cssText+="transition: 0.5s"},1)}setTimeout(function(){"slide-down"===i&&(m(e).css("z-index","1019"),m(t).css("z-index","1020")),t&&m(t).css({opacity:"1"}).css(w2utils.cssPrefix({transition:"",transform:""})),e&&m(e).css({opacity:"1"}).css(w2utils.cssPrefix({transition:"",transform:""})),"function"==typeof n&&n()},500)}else console.log("ERROR: Cannot do transition when one of the divs is null")},lock:function(e,t,i){var n={};"object"==typeof t?n=t:(n.msg=t,n.spinner=i);n.msg||0===n.msg||(n.msg="");w2utils.unlock(e),m(e).prepend('<div class="w2ui-lock"></div><div class="w2ui-lock-msg"></div>');t=m(e).find(".w2ui-lock"),i=m(e).find(".w2ui-lock-msg");n.msg||i.css({"background-color":"transparent",border:"0px"});!0===n.spinner&&(n.msg='<div class="w2ui-spinner" '+(n.msg?"":'style="width: 35px; height: 35px"')+"></div>"+n.msg);null!=n.opacity&&t.css("opacity",n.opacity);"function"==typeof t.fadeIn?(t.fadeIn(200),i.html(n.msg).fadeIn(200)):(t.show(),i.html(n.msg).show(0))},unlock:function(e,t){c(t)?(m(e).find(".w2ui-lock").fadeOut(t),setTimeout(function(){m(e).find(".w2ui-lock").remove(),m(e).find(".w2ui-lock-msg").remove()},t)):(m(e).find(".w2ui-lock").remove(),m(e).find(".w2ui-lock-msg").remove())},message:function(n,e){var t,s,o=this;m().w2tag(),e=e||{width:200,height:100};null==e.on&&m.extend(e,w2utils.event);null==e.width&&(e.width=200);null==e.height&&(e.height=100);var i=parseInt(m(n.box).width()),a=parseInt(m(n.box).height()),r=parseInt(m(n.box).find(n.title).css("height")||0);e.width>i&&(e.width=i-10);e.height>a-r&&(e.height=a-10-r);e.originalWidth=e.width,e.originalHeight=e.height,parseInt(e.width)<0&&(e.width=i+e.width);parseInt(e.width)<10&&(e.width=10);parseInt(e.height)<0&&(e.height=a+e.height-r);parseInt(e.height)<10&&(e.height=10);null==e.hideOnClick&&(e.hideOnClick=!1);var l=m(n.box).data("options")||{};(null==e.width||e.width>l.width-10)&&(e.width=l.width-10);(null==e.height||e.height>l.height-r-5)&&(e.height=l.height-r-5);e.originalHeight<0&&(e.height=a+e.originalHeight-r);e.originalWidth<0&&(e.width=i+2*e.originalWidth);var d=m(n.box).find(n.title),l=m(n.box).find(".w2ui-message.w2ui-closing");0<m(n.box).find(".w2ui-message.w2ui-closing").length&&(clearTimeout(t),h(l,l.data("options")||{}));var u=m(n.box).find(".w2ui-message").length;{var c,p;""===m.trim(e.html)&&""===m.trim(e.body)&&""===m.trim(e.buttons)?0!==u&&(c=m(n.box).find("#w2ui-message"+(u-1)),e=c.data("options")||{},!0!==(s=e.trigger({phase:"before",type:"close",target:"self"})).isCancelled)&&(c.css(w2utils.cssPrefix({transition:"0.15s",transform:"translateY(-"+e.height+"px)"})).addClass("w2ui-closing"),1===u?this.unlock&&(n.param?this.unlock(n.param,150):this.unlock(150)):m(n.box).find("#w2ui-message"+(u-2)).css("z-index",1500),t=setTimeout(function(){h(c,e)},150)):(""===m.trim(e.body)&&""===m.trim(e.buttons)||(e.html='<div class="w2ui-message-body">'+(e.body||"")+'</div><div class="w2ui-message-buttons">'+(e.buttons||"")+"</div>"),m(n.box).find(".w2ui-message").css("z-index",1390),d.data("old-z-index",d.css("z-index")),d.css("z-index",1501),m(n.box).find(n.body).before('<div id="w2ui-message'+u+'" onmousedown="event.stopPropagation();"    class="w2ui-message" style="display: none; z-index: 1500; '+(0===d.length?"top: 0px;":"top: "+w2utils.getSize(d,"height")+"px;")+(null!=e.width?"width: "+e.width+"px; left: "+(i-e.width)/2+"px;":"left: 10px; right: 10px;")+(null!=e.height?"height: "+e.height+"px;":"bottom: 6px;")+w2utils.cssPrefix("transition",".3s",!0)+'"'+(!0===e.hideOnClick?n.param?'onclick="'+n.path+".message('"+n.param+"');\"":'onclick="'+n.path+'.message();"':"")+"></div>"),m(n.box).find("#w2ui-message"+u).data("options",e).data("prev_focus",m(":focus")),p=m(n.box).find("#w2ui-message"+u).css("display"),m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transform:"none"===p?"translateY(-"+e.height+"px)":"translateY(0px)"})),"none"===p&&(m(n.box).find("#w2ui-message"+u).show().html(e.html),e.box=m(n.box).find("#w2ui-message"+u),!0===(s=e.trigger({phase:"before",type:"open",target:"self"})).isCancelled?(d.css("z-index",d.data("old-z-index")),m(n.box).find("#w2ui-message"+u).remove()):(setTimeout(function(){m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transform:"none"===p?"translateY(0px)":"translateY(-"+e.height+"px)"}))},1),0===u&&this.lock&&(n.param?this.lock(n.param):this.lock()),setTimeout(function(){m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transition:"0s"})),e.trigger(m.extend(s,{phase:"after"}))},350))))}function h(e,t){var i;null==s&&!0===(s=t.trigger({phase:"before",type:"open",target:"self"})).isCancelled?(d.css("z-index",d.data("old-z-index")),m(n.box).find("#w2ui-message"+u).remove()):(i=e.data("prev_focus"),e.remove(),i&&0<i.length?i.focus():o&&o.focus&&o.focus(),d.css("z-index",d.data("old-z-index")),t.trigger(m.extend(s,{phase:"after"})))}},naturalCompare:function(e,t){var n,i,s=1,o=0,a=0,r=String.alphabet;function l(e,t,i){if(i){for(n=t;(i=l(e,n))<76&&65<i;)++n;return+e.slice(t-1,n)}return-1<(i=r&&r.indexOf(e.charAt(t)))?i+76:(i=e.charCodeAt(t)||0)<45||127<i?i:i<46?65:i<48?i-1:i<58?i+18:i<65?i-11:i<91?i+11:i<97?i-37:i<123?i+5:i-63}if((e+="")!=(t+=""))for(;s;)if(i=l(e,o++),s=l(t,a++),i<76&&s<76&&66<i&&66<s&&(i=l(e,o,o),s=l(t,a,o=n),a=n),i!=s)return i<s?-1:1;return 0},lang:function(e){var t=this.settings.phrases[e];return null==t?e:t},locale:function(n,s){n=n||"en-us";"string"!=typeof n?w2utils.settings=m.extend(!0,w2utils.settings,n):(5===n.length&&(n="locale/"+n+".json"),w2utils.settings.phrases={},m.ajax({url:n,type:"GET",dataType:"JSON",success:function(e,t,i){w2utils.settings=m.extend(!0,w2utils.settings,e),"function"==typeof s&&s()},error:function(e,t,i){console.log("ERROR: Cannot load locale "+n)}}))},getSize:function(e,t){var i=m(e),n=parseInt(i.css("border-left-width"))||0,s=parseInt(i.css("border-right-width"))||0,o=parseInt(i.css("border-top-width"))||0,a=parseInt(i.css("border-bottom-width"))||0,r=parseInt(i.css("margin-left"))||0,l=parseInt(i.css("margin-right"))||0,d=parseInt(i.css("margin-top"))||0,u=parseInt(i.css("margin-bottom"))||0,c=parseInt(i.css("padding-left"))||0,p=parseInt(i.css("padding-right"))||0,h=parseInt(i.css("padding-top"))||0,f=parseInt(i.css("padding-bottom"))||0;switch(t){case"top":return o+d+h;case"bottom":return a+u+f;case"left":return n+r+c;case"right":return s+l+p;case"width":return n+s+r+l+c+p+parseInt(i.width());case"height":return o+a+d+u+h+f+parseInt(i.height());case"+width":return n+s+r+l+c+p;case"+height":return o+a+d+u+h+f}return 0},getStrWidth:function(e,t){t='<div id="_tmp_width" style="position: absolute; top: -900px;'+(t||"")+'">'+i(e)+"</div>";return m("body").append(t),e=m("#_tmp_width").width(),m("#_tmp_width").remove(),e},scrollBarSize:function(){return e.scrollBarSize||(m("body").append('<div id="_scrollbar_width" style="position: absolute; top: -300px; width: 100px; height: 100px; overflow-y: scroll;">    <div style="height: 120px">1</div></div>'),e.scrollBarSize=100-m("#_scrollbar_width > div").width(),m("#_scrollbar_width").remove(),0<=String(navigator.userAgent).indexOf("MSIE")&&(e.scrollBarSize=e.scrollBarSize/2)),e.scrollBarSize},checkName:function(e,t){if(e&&null!=e.name)if(null!=w2ui[e.name])console.log('ERROR: The parameter "name" is not unique. There are other objects already created with the same name (obj: '+e.name+").");else{if(w2utils.isAlphaNumeric(e.name))return!0;console.log('ERROR: The parameter "name" has to be alpha-numeric (a-z, 0-9, dash and underscore). ')}else console.log('ERROR: The parameter "name" is required but not supplied in $().'+t+"().");return!1},checkUniqueId:function(e,t,i,n){m.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++)if(t[s].id===e)return console.log('ERROR: The parameter "id='+e+'" is not unique within the current '+i+". (obj: "+n+")"),!1;return!0},parseRoute:function(e){var a=[],e=e.replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,t,i,n,s,o){return a.push({name:n,optional:!!o}),t=t||"",(o?"":t)+"(?:"+(o?t:"")+(i||"")+(s||(i?"([^/.]+?)":"([^/]+?)"))+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)");return{path:new RegExp("^"+e+"$","i"),keys:a}},cssPrefix:function(e,t,i){var n={},s={},o="";m.isPlainObject(e)?(n=e,!0===t&&(i=!0)):n[e]=t;for(a in n)s[a]=n[a],s["-webkit-"+a]=n[a],s["-moz-"+a]=n[a].replace("-webkit-","-moz-"),s["-ms-"+a]=n[a].replace("-webkit-","-ms-"),s["-o-"+a]=n[a].replace("-webkit-","-o-");if(!0===i)for(var a in s)o+=a+": "+s[a]+"; ";else o=s;return o},parseColor:function(e){{if("string"!=typeof e)return null;e=e.trim().toUpperCase()}"#"===e[0]&&(e=e.substr(1));var t={};if(3===e.length)t={r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:1};else if(6===e.length)t={r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:1};else if(8===e.length)t={r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:Math.round(parseInt(e.substr(6,2),16)/255*100)/100};else if(4<e.length&&"RGB("===e.substr(0,4)){var i=e.replace("RGB","").replace(/\(/g,"").replace(/\)/g,"").split(",");t={r:parseInt(i[0],10),g:parseInt(i[1],10),b:parseInt(i[2],10),a:1}}else{if(!(5<e.length&&"RGBA("===e.substr(0,5)))return null;i=e.replace("RGBA","").replace(/\(/g,"").replace(/\)/g,"").split(",");t={r:parseInt(i[0],10),g:parseInt(i[1],10),b:parseInt(i[2],10),a:parseFloat(i[3])}}return t},hsv2rgb:function(e,t,i,n){var s,o,a,r,l,d,u,c;1===arguments.length&&(t=e.s,i=e.v,n=e.a,e=e.h);switch(e/=360,t/=100,i/=100,r=Math.floor(6*e),d=i*(1-t),u=i*(1-(l=6*e-r)*t),c=i*(1-(1-l)*t),r%6){case 0:s=i,o=c,a=d;break;case 1:s=u,o=i,a=d;break;case 2:s=d,o=i,a=c;break;case 3:s=d,o=u,a=i;break;case 4:s=c,o=d,a=i;break;case 5:s=i,o=d,a=u}return{r:Math.round(255*s),g:Math.round(255*o),b:Math.round(255*a),a:null!=n?n:1}},rgb2hsv:function(e,t,i,n){1===arguments.length&&(t=e.g,i=e.b,n=e.a,e=e.r);var s,o=Math.max(e,t,i),a=Math.min(e,t,i),r=o-a,l=0===o?0:r/o,d=o/255;switch(o){case a:s=0;break;case e:s=t-i+r*(t<i?6:0),s/=6*r;break;case t:s=i-e+2*r,s/=6*r;break;case i:s=e-t+4*r,s/=6*r}return{h:Math.round(360*s),s:Math.round(100*l),v:Math.round(100*d),a:null!=n?n:1}},tooltip:function(e,t){var i="mouseenter",n="mouseleave";(t=t||{}).showOn&&(i=t.showOn,delete t.showOn);t.hideOn&&(n=t.hideOn,delete t.hideOn);return"on"+i+"=\"$(this).w2tag(w2utils.base64decode('"+w2utils.base64encode(e)+"'),JSON.parse(w2utils.base64decode('"+w2utils.base64encode(JSON.stringify(t))+"')))\"on"+n+'="$(this).w2tag()"'},getCursorPosition:function(e){if(null==e)return null;var t,i=0,n=e.ownerDocument||e.document,s=n.defaultView||n.parentWindow;{var o;e.tagName&&"INPUT"===e.tagName.toUpperCase()&&e.selectionStart?i=e.selectionStart:s.getSelection?0<(t=s.getSelection()).rangeCount&&(s=t.getRangeAt(0),(o=s.cloneRange()).selectNodeContents(e),o.setEnd(s.endContainer,s.endOffset),i=o.toString().length):(t=n.selection)&&"Control"!==t.type&&(s=t.createRange(),(o=n.body.createTextRange()).moveToElementText(e),o.setEndPoint("EndToEnd",s),i=o.text.length)}return i},setCursorPosition:function(e,t,i){var n,s=document.createRange(),o=window.getSelection();if(null!=e){for(var a=0;a<e.childNodes.length;a++){var r=m(e.childNodes[a]).text();if(e.childNodes[a].tagName&&(r=(r=m(e.childNodes[a]).html()).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")),t<=r.length){(n=(n=e.childNodes[a]).childNodes&&0<n.childNodes.length?n.childNodes[0]:n).childNodes&&0<n.childNodes.length&&(n=n.childNodes[0]);break}t-=r.length}null!=n&&(t>n.length&&(t=n.length),s.setStart(n,t),i?s.setEnd(n,i):s.collapse(!0),o.removeAllRanges(),o.addRange(s))}},testLocalStorage:t,hasLocalStorage:t(),isIOS:-1!==navigator.userAgent.toLowerCase().indexOf("iphone")||-1!==navigator.userAgent.toLowerCase().indexOf("ipod")||-1!==navigator.userAgent.toLowerCase().indexOf("ipad")||-1!==navigator.userAgent.toLowerCase().indexOf("mobile")||-1!==navigator.userAgent.toLowerCase().indexOf("android"),isIE:-1!==navigator.userAgent.toLowerCase().indexOf("msie")||-1!==navigator.userAgent.toLowerCase().indexOf("trident")};function c(e){return/^[-+]?[0-9]+$/.test(e)}function i(e){if(null!=e)switch(typeof e){case"number":break;case"string":e=String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.encodeTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.encodeTags(e[t])}return e}function t(){var e="w2ui_test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}}(jQuery);w2utils.formatters={number:function(e,t){return 20<parseInt(t)&&(t=20),parseInt(t)<0&&(t=0),null==e||""===e?"":w2utils.formatNumber(parseFloat(e),t,!0)},float:function(e,t){return w2utils.formatters.number(e,t)},int:function(e,t){return w2utils.formatters.number(e,0)},money:function(e,t){return null==e||""===e?"":(e=w2utils.formatNumber(Number(e),w2utils.settings.currencyPrecision||2),(w2utils.settings.currencyPrefix||"")+e+(w2utils.settings.currencySuffix||""))},currency:function(e,t){return w2utils.formatters.money(e,t)},percent:function(e,t){return null==e||""===e?"":w2utils.formatNumber(e,t||1)+"%"},size:function(e,t){return null==e||""===e?"":w2utils.formatSize(parseInt(e))},date:function(e,t){var i;return""===t&&(t=w2utils.settings.dateFormat),null==e||0===e||""===e?"":'<span title="'+(i=!1===(i=w2utils.isDateTime(e,t,!0))?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatDate(i,t)+"</span>"},datetime:function(e,t){var i;return""===t&&(t=w2utils.settings.datetimeFormat),null==e||0===e||""===e?"":'<span title="'+(i=!1===(i=w2utils.isDateTime(e,t,!0))?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatDateTime(i,t)+"</span>"},time:function(e,t){var i;return""===t&&(t=w2utils.settings.timeFormat),null==e||0===e||""===e?"":'<span title="'+(i=!1===(i=w2utils.isDateTime(e,t="h24"===(t="h12"===t?"hh:mi pm":t)?"h24:mi":t,!0))?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatTime(e,t)+"</span>"},timestamp:function(e,t){var i;return""===t&&(t=w2utils.settings.datetimeFormat),null!=e&&0!==e&&""!==e&&(i=!1===(i=w2utils.isDateTime(e,t,!0))?w2utils.isDate(e,t,!0):i).toString?i.toString():""},gmt:function(e,t){var i;return""===t&&(t=w2utils.settings.datetimeFormat),null!=e&&0!==e&&""!==e&&(i=!1===(i=w2utils.isDateTime(e,t,!0))?w2utils.isDate(e,t,!0):i).toUTCString?i.toUTCString():""},age:function(e,t){var i;return null==e||0===e||""===e?"":'<span title="'+(i=!1===(i=w2utils.isDateTime(e,null,!0))?w2utils.isDate(e,null,!0):i)+'">'+w2utils.age(e)+(t?" "+t:"")+"</span>"},interval:function(e,t){return null==e||0===e||""===e?"":w2utils.interval(e)+(t?" "+t:"")},toggle:function(e,t){return e?"Yes":""},password:function(e,t){for(var i="",n=0;n<e.length;n++)i+="*";return i}},w2utils.event={on:function(e,t){var i,n,s=jQuery;if("string"==typeof e&&-1!==e.indexOf(".")&&(e=(n=e.split("."))[0],i=n[1]),"string"==typeof e&&-1!==e.indexOf(":")&&(n=e.split(":"),-1!==["complete","done"].indexOf(e[1])&&(e[1]="after"),e={type:n[0],execute:n[1]},i)&&(e.scope=i),s.isPlainObject(e)||(e={type:e,scope:i}),(e=s.extend({type:null,execute:"before",target:null,onComplete:null},e)).type){if(t)return s.isArray(this.handlers)||(this.handlers=[]),this.handlers.push({edata:e,handler:t}),this;console.log("ERROR: You must specify event handler function when calling .on() method of "+this.name)}else console.log("ERROR: You must specify event type when calling .on() method of "+this.name)},off:function(e,t){var i,n,s=jQuery;if("string"==typeof(e="string"==typeof e&&-1!==e.indexOf(".")&&(e=(n=e.split("."))[0],i=n[1],""===e)?"*":e)&&-1!==e.indexOf(":")&&(n=e.split(":"),-1!==["complete","done"].indexOf(e[1])&&(e[1]="after"),e={type:n[0],execute:n[1]}),s.isPlainObject(e)||(e={type:e}),(e=s.extend({},{type:null,execute:null,target:null,onComplete:null},e)).type||i){t=t||null;for(var o=[],a=0,r=this.handlers.length;a<r;a++){var l=this.handlers[a];(l.edata.type!==e.type&&"*"!==e.type&&(null==l.edata.scope||""!=e.type)||l.edata.target!==e.target&&null!=e.target||l.edata.execute!==e.execute&&null!=e.execute||!(l.handler===t&&null!=t||null!=i&&l.edata.scope==i))&&o.push(l)}return this.handlers=o,this}console.log("ERROR: You must specify event type when calling .off() method of "+this.name)},trigger:function(e){var t,i,n,s=jQuery;"before"===(e=s.extend({type:null,phase:"before",target:null,doneHandlers:[]},e,{isStopped:!1,isCancelled:!1,done:function(e){this.doneHandlers.push(e)},preventDefault:function(){this.isCancelled=!0},stopPropagation:function(){this.isStopped=!0}})).phase&&(e.onComplete=null),null==e.target&&(e.target=null),s.isArray(this.handlers)||(this.handlers=[]);for(var o=this.handlers.length-1;0<=o;o--){var a=this.handlers[o];if(!(null==a||a.edata.type!==e.type&&"*"!==a.edata.type||a.edata.target!==e.target&&null!=a.edata.target||a.edata.execute!==e.phase&&"*"!==a.edata.execute&&"*"!==a.edata.phase)&&(e=s.extend({},a.edata,e),t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(a.handler))?n[1].split(/\s*,\s*/):t).length?a.handler.call(this,e.target,e):a.handler.call(this,e),!0===e.isStopped||!0===e.stop))return e}var r="on"+e.type.substr(0,1).toUpperCase()+e.type.substr(1);if(!("before"===e.phase&&"function"==typeof this[r]&&(i=this[r],t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(i))?n[1].split(/\s*,\s*/):t).length?i.call(this,e.target,e):i.call(this,e),!0===e.isStopped||!0===e.stop)||null!=e.object&&"before"===e.phase&&"function"==typeof e.object[r]&&(i=e.object[r],t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(i))?n[1].split(/\s*,\s*/):t).length?i.call(this,e.target,e):i.call(this,e),!0===e.isStopped||!0===e.stop)||"after"!==e.phase)){"function"==typeof e.onComplete&&e.onComplete.call(this,e);for(var l=0;l<e.doneHandlers.length;l++)"function"==typeof e.doneHandlers[l]&&e.doneHandlers[l].call(this,e)}return e}},function(v){v.fn.w2render=function(e){0<v(this).length&&("string"==typeof e&&w2ui[e]&&w2ui[e].render(v(this)[0]),"object"==typeof e)&&e.render(v(this)[0])},v.fn.w2destroy=function(e){"string"==typeof(e=!e&&0<this.length?this.attr("name"):e)&&w2ui[e]&&w2ui[e].destroy(),"object"==typeof e&&e.destroy()},v.fn.w2marker=function(){var o=Array.prototype.slice.call(arguments,0);return 0!==(o=Array.isArray(o[0])?o[0]:o).length&&o[0]?v(this).each(function(e,t){a(0,t);for(var i=0;i<o.length;i++){var n=o[i],n=(n=(n="string"!=typeof n?String(n):n).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace(/&/g,"&amp;").replace(/</g,"&gt;").replace(/>/g,"&lt;"),new RegExp(n+"(?!([^<]+)?>)","gi"));t.innerHTML=t.innerHTML.replace(n,s)}function s(e){return'<span class="w2ui-marker">'+e+"</span>"}}):v(this).each(a);function a(e,t){for(;-1!==t.innerHTML.indexOf('<span class="w2ui-marker">');)t.innerHTML=t.innerHTML.replace(/\<span class=\"w2ui\-marker\"\>((.|\n|\r)*)\<\/span\>/gi,"$1")}},v.fn.w2tag=function(r,l){if(1===arguments.length&&"object"==typeof r&&null!=(l=r).html&&(r=l.html),null!=(l=v.extend({id:null,auto:null,html:r,position:"right|top",align:"none",left:0,top:0,maxWidth:null,style:"",css:{},className:"",inputClass:"",onShow:null,onHide:null,hideOnKeyPress:!0,hideOnFocus:!1,hideOnBlur:!1,hideOnClick:!1,hideOnChange:!0},l)).name&&null==l.id&&(l.id=l.name),""!==l.class&&""===l.inputClass&&(l.inputClass=l.class),0!==v(this).length)return!0===l.auto||null!=l.showOn||null!=l.hideOn?0!=arguments.length&&r?v(this).each(function(e,t){var i="mouseenter",n="mouseleave";l.showOn&&(i=String(l.showOn).toLowerCase(),delete l.showOn),l.hideOn&&(n=String(l.hideOn).toLowerCase(),delete l.hideOn),l.potision||(l.position="top|bottom"),v(t).off(".w2tooltip").on(i+".w2tooltip",function(){l.auto=!1,v(this).w2tag(r,l)}).on(n+".w2tooltip",function(){v(this).w2tag()})}):v(this).each(function(e,t){v(t).off(".w2tooltip")}):v(this).each(function(e,t){var c,i=l.id||t.id,n=(""==i&&(i=v(t).find("input").attr("id")),w2utils.escapeId(i=i||"noid"));function s(){var e;c.box.css("display","block"),c&&c.box&&v(c.attachedTo).offset()&&(e=c.getPos(),c.box.css({opacity:"1",left:e.left+"px",top:e.top+"px"}).data("w2tag",c).find(".w2ui-tag-body").addClass(e.posClass),c.tmp.pos=e.left+"x"+e.top,v(c.attachedTo).off(".w2tag").css(c.options.css).addClass(c.options.inputClass),c.options.hideOnKeyPress&&v(c.attachedTo).on("keypress.w2tag",c.hide),c.options.hideOnFocus&&v(c.attachedTo).on("focus.w2tag",c.hide),l.hideOnChange&&("INPUT"===t.nodeName?v(t):v(t).find("input")).on("change.w2tag",c.hide),c.options.hideOnBlur&&v(c.attachedTo).on("blur.w2tag",c.hide),c.options.hideOnClick&&v("body").on("click.w2tag"+(c.id||""),c.hide),"function"==typeof c.options.onShow&&c.options.onShow(),o())}function o(e){var t=v(c.attachedTo).offset();0===v(c.attachedTo).length||0===t.left&&0===t.top||0===c.box.find(".w2ui-tag-body").length?c.hide():(t=a(),c.tmp.pos!==t.left+"x"+t.top&&(c.box.css(w2utils.cssPrefix({transition:e?"0s":".2s"})).css({left:t.left+"px",top:t.top+"px"}),c.tmp.pos=t.left+"x"+t.top),c.tmp.timer&&clearTimeout(c.tmp.timer),c.tmp.timer=setTimeout(o,100))}function a(){var e=v(c.attachedTo).offset(),t="w2ui-tag-right",i=parseInt(e.left+c.attachedTo.offsetWidth+(c.options.left||0)),n=parseInt(e.top+(c.options.top||0)),s=c.box.find(".w2ui-tag-body"),o=s[0].offsetWidth,a=s[0].offsetHeight;if("string"==typeof c.options.position&&-1!==c.options.position.indexOf("|")&&(c.options.position=c.options.position.split("|")),"top"===c.options.position)t="w2ui-tag-top",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+(c.options.top||0))-a-10;else if("bottom"===c.options.position)t="w2ui-tag-bottom",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+c.attachedTo.offsetHeight+(c.options.top||0))+10;else if("left"===c.options.position)t="w2ui-tag-left",i=parseInt(e.left+(c.options.left||0))-o-20,n=parseInt(e.top+(c.options.top||0));else if(Array.isArray(c.options.position)){for(var r=window.innerWidth,l=window.innerHeight,d=0;d<c.options.position.length;d++){var u=c.options.position[d];if("right"===u){if(t="w2ui-tag-right",i=parseInt(e.left+c.attachedTo.offsetWidth+(c.options.left||0)),n=parseInt(e.top+(c.options.top||0)),i+o<=r)break}else if("left"===u){if(t="w2ui-tag-left",i=parseInt(e.left+(c.options.left||0))-o-20,n=parseInt(e.top+(c.options.top||0)),0<=i)break}else if("top"===u){if(t="w2ui-tag-top",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+(c.options.top||0))-a-10,i+o<=r&&0<=n)break}else if("bottom"===u&&(t="w2ui-tag-bottom",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+c.attachedTo.offsetHeight+(c.options.top||0))+10,i+o<=r)&&n+a<=l)break}s.data("posClass")!==t&&s.removeClass("w2ui-tag-right w2ui-tag-left w2ui-tag-top w2ui-tag-bottom").addClass(t).data("posClass",t)}return{left:i,top:n,posClass:t}}null!=v(this).data("w2tag")?(c=v(this).data("w2tag"),v.extend(c.options,l)):c={id:i,attachedTo:t,box:v("#w2ui-tag-"+n),options:v.extend({},l),init:s,hide:function(){c.box.length<=0||(c.tmp.timer&&clearTimeout(c.tmp.timer),c.box.remove(),c.options.hideOnClick&&v("body").off(".w2tag"+(c.id||"")),v(c.attachedTo).off(".w2tag").removeClass(c.options.inputClass).removeData("w2tag"),0<v(c.attachedTo).length&&(v(c.attachedTo)[0].style.cssText=c.tmp.originalCSS),"function"==typeof c.options.onHide&&c.options.onHide())},getPos:a,isMoved:o,tmp:{}},""===r||null==r?c.hide():0!==c.box.length?c.box.find(".w2ui-tag-body").css(c.options.css).attr("style",c.options.style).addClass(c.options.className).html(c.options.html):(c.tmp.originalCSS="",0<v(c.attachedTo).length&&(c.tmp.originalCSS=v(c.attachedTo)[0].style.cssText),i="white-space: nowrap;",c.options.maxWidth&&w2utils.getStrWidth(r)>c.options.maxWidth&&(i="width: "+c.options.maxWidth+"px"),v("body").append('<div onclick="event.stopPropagation()" style="display: none;" id="w2ui-tag-'+c.id+'"        class="w2ui-tag '+(0<v(c.attachedTo).parents(".w2ui-popup, .w2ui-overlay-popup, .w2ui-message").length?"w2ui-tag-popup":"")+'">   <div style="margin: -2px 0px 0px -2px; '+i+'">      <div class="w2ui-tag-body '+c.options.className+'" style="'+(c.options.style||"")+'">'+r+"</div>   </div></div>"),c.box=v("#w2ui-tag-"+n),v(c.attachedTo).data("w2tag",c),setTimeout(s,1))});v(".w2ui-tag").each(function(e,t){t=v(t).data("w2tag");t&&t.hide()})},v.fn.w2overlay=function(e,f){var t,i,n,m=this,g="";return 1===arguments.length&&(f="object"==typeof e?e:{html:e}),2===arguments.length&&(f.html=e),v.isPlainObject(f)||(f={}),(f=v.extend({},{name:null,html:"",align:"none",left:0,top:0,tipLeft:30,noTip:!1,selectable:!1,width:0,height:0,maxWidth:null,maxHeight:null,contextMenu:!1,pageX:null,pageY:null,originalEvent:null,style:"",class:"",overlayStyle:"",onShow:null,onHide:null,openAbove:null,tmp:{}},f)).name&&(g="-"+f.name),0===this.length||""===f.html||null==f.html?0<v("#w2ui-overlay"+g).length?"function"==typeof(i=v("#w2ui-overlay"+g)[0].hide)&&i():v("#w2ui-overlay"+g).remove():(0<v("#w2ui-overlay"+g).length&&(i=v("#w2ui-overlay"+g)[0].hide,v(document).off(".w2overlay"+g),"function"==typeof i)&&i(),0<m.length&&(null==m[0].tagName||"BODY"===m[0].tagName.toUpperCase())&&(f.contextMenu=!0),f.contextMenu&&f.originalEvent&&(f.pageX=f.originalEvent.pageX,f.pageY=f.originalEvent.pageY),!f.contextMenu||null!=f.pageX&&null!=f.pageY||console.log("ERROR: to display menu at mouse location, pass options.pageX and options.pageY."),t="",f.data&&Object.keys(f.data).forEach(function(e){t+="data-"+e+'="'+f.data[e]+'"'}),v("body").append('<div id="w2ui-overlay'+g+'" style="display: none; left: 0px; top: 0px; '+f.overlayStyle+'" '+t+'        class="w2ui-reset w2ui-overlay '+(0<v(this).parents(".w2ui-popup, .w2ui-overlay-popup, .w2ui-message").length?"w2ui-overlay-popup":"")+'">    <style></style>    <div style="min-width: 100%; '+f.style+'" class="'+f.class+'"></div></div>'),(n=(i=v("#w2ui-overlay"+g)).find(" > div")).html(f.html),n=(null!=(n=n.css("background-color"))&&"rgba(0, 0, 0, 0)"!==n&&"transparent"!==n&&i.css({"background-color":n,"border-color":n}),v(m).offset()||{}),i.data("element",0<m.length?m[0]:null).data("options",f).data("position",n.left+"x"+n.top).fadeIn("fast").on("click",function(e){v("#w2ui-overlay"+g).data("keepOpen",!0),"LABEL"===e.target.tagName.toUpperCase()&&e.stopPropagation()}).on("mousedown",function(e){var t=e.target.tagName.toUpperCase();-1!==["INPUT","TEXTAREA","SELECT"].indexOf(t)||f.selectable||e.preventDefault()}),i[0].hide=s,i[0].resize=w,setTimeout(function(){v(document).off(".w2overlay"+g).on("click.w2overlay"+g,s),"function"==typeof f.onShow&&f.onShow(),w()},10),function e(){var t=v("#w2ui-overlay"+g);if(t.data("element")!==m[0])return;if(0===t.length)return;var i=v(m).offset()||{};i=i.left+"x"+i.top;t.data("position")!==i?s():setTimeout(e,250)}()),v(this);function s(e){var t,i;e&&0!==e.button||(t=v("#w2ui-overlay"+g),e&&v(v(e.target).closest(".w2ui-overlay").data("element")).closest(".w2ui-overlay")[0]===t[0])||(!0===t.data("keepOpen")?t.removeData("keepOpen"):!1!==(i="function"==typeof f.onHide?f.onHide():i)&&(t.remove(),v(document).off(".w2overlay"+g),clearInterval(t.data("timer"))))}function w(){var e=v("#w2ui-overlay"+g),t=e.find(" > div"),i=v("#w2ui-overlay"+g+" div.w2ui-menu"),n={};if(0<i.length&&(i.css("overflow-y","hidden"),n.scrollTop=i.scrollTop(),n.scrollLeft=i.scrollLeft()),0<e.length){t.height("auto").width("auto");var s=!1,o=t.height(),a=t.width(),r=((a=f.width&&f.width<a?f.width:a)<30&&(a=30),f.tmp.contentHeight&&(o=parseInt(f.tmp.contentHeight),t.height(o),setTimeout(function(){var e=t.find("div.w2ui-menu");o>e.height()&&t.find("div.w2ui-menu").css("overflow-y","hidden")},1),setTimeout(function(){var e=t.find("div.w2ui-menu");"auto"!==e.css("overflow-y")&&e.css("overflow-y","auto")},10)),f.tmp.contentWidth&&"both"!==f.align?(a=parseInt(f.tmp.contentWidth),t.width(a),setTimeout(function(){a>t.find("div.w2ui-menu > table").width()&&t.find("div.w2ui-menu > table").css("overflow-x","hidden")},1),setTimeout(function(){t.find("div.w2ui-menu > table").css("overflow-x","auto")},10)):t.find("div.w2ui-menu").css("width","100%"),f.left),l=f.width,d=f.tipLeft;switch(f.align){case"both":r=17,0===f.width&&(f.width=w2utils.getSize(v(m),"width")),f.maxWidth&&f.width>f.maxWidth&&(f.width=f.maxWidth);break;case"left":r=17;break;case"right":r=w2utils.getSize(v(m),"width")-a+10,d=a-40}var u="auto"!==(l=30!==a||l?f.width||"auto":30)?(l-17)/2:(a-17)/2,c=(u<25&&(r=25-u,d=Math.floor(u)),u=f.contextMenu?(p=f.pageX+8,h=+f.pageY,f.pageY):(p=(25<(c=m.offset()||{}).left?c.left:25)+r,h=c.top+w2utils.getSize(m,"height")+f.top+7,c.top),e.css({left:p+"px",top:h+"px","min-width":l,"min-height":f.height||"auto"}),t.offset()||{}),p=window.innerHeight+v(document).scrollTop()-c.top-7,h=window.innerWidth+v(document).scrollLeft()-c.left-7;f.contextMenu&&(p=window.innerHeight+v(document).scrollTop()-f.pageY-15,h=window.innerWidth+v(document).scrollLeft()-f.pageX),(-50<p&&p<210||!0===f.openAbove)&&!1!==f.openAbove?(l=f.contextMenu?(p=f.pageY-7,5):(p=c.top-v(document).scrollTop()-7,24),(p=f.maxHeight&&p>f.maxHeight?f.maxHeight:p)<o&&(s=!0,t.height(p).width(a).css({"overflow-y":"auto"}),o=p),e.addClass("bottom-arrow"),e.css("top",u-o-l+f.top+"px")):((p=f.maxHeight&&p>f.maxHeight?f.maxHeight:p)<o&&(s=!0,t.height(p).width(a).css({"overflow-y":"auto"})),e.addClass("top-arrow")),e.find(">style").html("#w2ui-overlay"+g+":before { margin-left: "+parseInt(d)+"px; }#w2ui-overlay"+g+":after { margin-left: "+parseInt(d)+"px; }"),a=t.width(),h=window.innerWidth+v(document).scrollLeft()-c.left-7,(h=f.maxWidth&&h>f.maxWidth?f.maxWidth:h)<a&&"both"!==f.align&&(f.align="right",setTimeout(function(){w()},1)),(f.contextMenu||f.noTip)&&e.find(">style").html("#w2ui-overlay"+g+":before { display: none; }#w2ui-overlay"+g+":after { display: none; }"),s&&"both"!==f.align&&t.width(a+w2utils.scrollBarSize()+2)}0<i.length&&(i.css("overflow-y","auto"),i.scrollTop(n.scrollTop),i.scrollLeft(n.scrollLeft))}},v.fn.w2menu=function(e,w){w&&"function"==typeof w.items&&(w.items=w.items());var t,l=this,d="";if("refresh"===e)v.fn.w2menuOptions&&v.fn.w2menuOptions.name&&(d="-"+v.fn.w2menuOptions.name),w.name&&(d="-"+w.name),0<v("#w2ui-overlay"+d).length?(w=v.extend(v.fn.w2menuOptions,w),a=v("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(),v("#w2ui-overlay"+d+" div.w2ui-menu").html(y()),v("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(a),u()):v(this).w2menu(w);else if("refresh-index"===e){var i,n,s=v("#w2ui-overlay"+d+" div.w2ui-menu"),o=s.find("tr[index="+w.index+"]"),a=s.scrollTop();s.find("tr.w2ui-selected").removeClass("w2ui-selected"),o.addClass("w2ui-selected"),0<o.length&&(i=o[0].offsetTop-5,n=s.height(),s.scrollTop(a),i<a||i+o.height()>a+n)&&s.animate({scrollTop:i-(n-2*o.height())/2},200,"linear"),u()}else{1===arguments.length?w=e:w.items=e,"object"!=typeof w&&(w={}),w=v.extend({},{type:"normal",index:null,items:[],render:null,msgNoItems:"No items",onSelect:null,hideOnRemove:!1,tmp:{}},w),(v.fn.w2menuOptions=w).name&&(d="-"+w.name),"function"==typeof w.select&&"function"!=typeof w.onSelect&&(w.onSelect=w.select),"function"==typeof w.remove&&"function"!=typeof w.onRemove&&(w.onRemove=w.remove),"function"==typeof w.onRender&&"function"!=typeof w.render&&(w.render=w.onRender),v.fn.w2menuClick=function(e,t,i){var n=!1,s=v(e.target).closest("tr");(e.shiftKey||e.metaKey||e.ctrlKey)&&(n=!0),items=(null==i?w:w.items[i]).items,v(e.target).hasClass("remove")?("function"==typeof w.onRemove&&w.onRemove({index:t,parentIndex:i,item:items[t],keepOpen:n,originalEvent:e}),n=!w.hideOnRemove,v(e.target).closest("tr").remove(),u()):s.hasClass("has-sub-menu")?(n=!0,s.hasClass("expanded")?(items[t].expanded=!1,s.removeClass("expanded").addClass("collapsed").next().hide()):(items[t].expanded=!0,s.addClass("expanded").removeClass("collapsed").next().show()),u()):"function"==typeof w.onSelect&&(null!=(s="function"==typeof(s=items)?items(w.items[i]):s)[t].keepOpen&&(n=s[t].keepOpen),w.onSelect({index:t,parentIndex:i,item:s[t],keepOpen:n,originalEvent:e})),null!=items[t]&&!0===items[t].keepOpen||((i=v("#w2ui-overlay"+d)).removeData("keepOpen"),0<i.length&&"function"==typeof i[0].hide&&!n&&i[0].hide())},v.fn.w2menuDown=function(e,t,i){var n=v(e.target).closest("tr"),s=v(n.get(0)).find(".w2ui-icon"),o=(null==i?w:w.items[i]).items,a=o[t];"check"!==w.type&&"radio"!==w.type||!1===a.group||v(e.target).hasClass("remove")||v(e.target).closest("tr").hasClass("has-sub-menu")||(a.checked=!a.checked,a.checked?("radio"===w.type&&s.parents("table").find(".w2ui-icon").removeClass("w2ui-icon-check").addClass("w2ui-icon-empty"),"check"===w.type&&null!=a.group&&o.forEach(function(e,t){e.id!=a.id&&e.group===a.group&&e.checked&&(s.closest("table").find("tr[index="+t+"] .w2ui-icon").removeClass("w2ui-icon-check").addClass("w2ui-icon-empty"),o[t].checked=!1)}),s.removeClass("w2ui-icon-empty").addClass("w2ui-icon-check")):"check"===w.type&&null==a.group&&!1!==a.group&&s.removeClass("w2ui-icon-check").addClass("w2ui-icon-empty")),n.parent().find("tr").removeClass("w2ui-selected"),n.addClass("w2ui-selected")};a="";if(w.search){a+='<div style="position: absolute; top: 0px; height: 40px; left: 0px; right: 0px; border-bottom: 1px solid silver; background-color: #ECECEC; padding: 8px 5px;">    <div class="w2ui-icon icon-search" style="position: absolute; margin-top: 4px; margin-left: 6px; width: 11px; background-position: left !important;"></div>    <input id="menu-search" type="text" style="width: 100%; outline: none; padding-left: 20px;" onclick="event.stopPropagation();"/></div>',w.style+=";background-color: #ECECEC";for(var r=w.index=0;r<w.items.length;r++)w.items[r].hidden=!1}a+=(w.topHTML||"")+'<div class="w2ui-menu" style="top: '+(w.search?40:0)+"px;"+(w.menuStyle||"")+'">'+y()+"</div>",t=v(this).w2overlay(a,w),setTimeout(function(){if(v("#w2ui-overlay"+d+" #menu-search").on("keyup",c).on("keydown",function(e){9===e.keyCode&&(e.stopPropagation(),e.preventDefault())}),w.search){if(-1!==["text","password"].indexOf(v(l)[0].type)||"TEXTAREA"===v(l)[0].tagName.toUpperCase())return;v("#w2ui-overlay"+d+" #menu-search").focus()}u()},250),u();s=v("#w2ui-overlay"+d);0<s.length&&(s[0].mresize=u,s[0].change=c)}return t;function u(){setTimeout(function(){v("#w2ui-overlay"+d+" tr.w2ui-selected").removeClass("w2ui-selected");var e,t,i=v("#w2ui-overlay"+d+" tr[index="+w.index+"]"),n=v("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop();i.addClass("w2ui-selected"),w.tmp&&(w.tmp.contentHeight=v("#w2ui-overlay"+d+" table").height()+(w.search?50:10)+(parseInt(v("#w2ui-overlay"+d+" .w2ui-menu").css("top"))||0)+(parseInt(v("#w2ui-overlay"+d+" .w2ui-menu").css("bottom"))||0),w.tmp.contentWidth=v("#w2ui-overlay"+d+" table").width()),0<v("#w2ui-overlay"+d).length&&v("#w2ui-overlay"+d)[0].resize(),0<i.length&&(e=i[0].offsetTop-5,t=v("#w2ui-overlay"+d+" div.w2ui-menu").height(),v("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(n),e<n||e+i.height()>n+t)&&v("#w2ui-overlay"+d+" div.w2ui-menu").animate({scrollTop:e-(t-2*i.height())/2},200,"linear")},1)}function c(e){var t=this.value,i=!1;switch(e.keyCode){case 13:v("#w2ui-overlay"+d).remove(),v.fn.w2menuClick(e,w.index);break;case 9:case 27:v("#w2ui-overlay"+d).remove(),v.fn.w2menuClick(e,-1);break;case 38:for(w.index=w2utils.isInt(w.index)?parseInt(w.index):0,w.index--;0<w.index&&w.items[w.index].hidden;)w.index--;if(0===w.index&&w.items[w.index].hidden)for(;w.items[w.index]&&w.items[w.index].hidden;)w.index++;w.index<0&&(w.index=0),i=!0;break;case 40:for(w.index=w2utils.isInt(w.index)?parseInt(w.index):0,w.index++;w.index<w.items.length-1&&w.items[w.index].hidden;)w.index++;if(w.index===w.items.length-1&&w.items[w.index].hidden)for(;w.items[w.index]&&w.items[w.index].hidden;)w.index--;w.index>=w.items.length&&(w.index=w.items.length-1),i=!0}if(!i){for(var n=0,s=0;s<w.items.length;s++){var o=w.items[s],a="",r="";-1!==["is","begins with"].indexOf(w.match)&&(a="^"),-1!==["is","ends with"].indexOf(w.match)&&(r="$");try{new RegExp(a+t+r,"i").test(o.text)||"..."===o.text?o.hidden=!1:o.hidden=!0}catch(e){}"enum"===l.type&&-1!==v.inArray(o.id,ids)&&(o.hidden=!0),!0!==o.hidden&&n++}for(w.index=0;w.index<w.items.length-1&&w.items[w.index].hidden;)w.index++;n<=0&&(w.index=-1)}v(l).w2menu("refresh",w),u()}function y(e,t,i,n){if(w.spinner)return'<table><tbody><tr><td style="padding: 5px 10px 13px 10px; text-align: center">    <div class="w2ui-spinner" style="width: 18px; height: 18px; position: relative; top: 5px;"></div>     <div style="display: inline-block; padding: 3px; color: #999;">'+w2utils.lang("Loading...")+"</div></td></tr></tbody></table>";var s=0,o='<table cellspacing="0" cellpadding="0" class="'+(t?" sub-menu":"")+'"><tbody>',a=null,r=null;null==e&&(e=w.items),Array.isArray(e)||(e=[]);for(var l=0;l<e.length;l++){var d,u,c,p,h,f,m,g=e[l];"string"==typeof g?g={id:g,text:g}:(null!=g.text&&null==g.id&&(g.id=g.text),null==g.text&&null!=g.id&&(g.text=g.id),null!=g.caption&&(g.text=g.caption),null==(a=g.img)&&(a=null),null==(r=g.icon)&&(r=null)),-1==["radio","check"].indexOf(w.type)||Array.isArray(g.items)||!1===g.group||(r=!0===g.checked?"w2ui-icon-check":"w2ui-icon-empty"),!0!==g.hidden&&(u=g.text,c=d="","function"==typeof(u="function"==typeof w.render?w.render(g,w):u)&&(u=u(g,w)),a&&(d='<td class="menu-icon"><div class="w2ui-tb-image w2ui-icon '+a+'"></div></td>'),r&&(d='<td class="menu-icon" align="center"><span class="w2ui-icon '+r+'"></span></td>'),"break"!==g.type&&null!=u&&""!==u&&"--"!=String(u).substr(0,2)?(p=s%2==0?"w2ui-item-even":"w2ui-item-odd",!0!==w.altRows&&(p=""),h=1,""===d&&h++,null==g.count&&null==g.hotkey&&!0!==g.remove&&null==g.items&&h++,null==g.tooltip&&null!=g.hint&&(g.tooltip=g.hint),!(f="")===g.remove?f='<span class="remove">X</span>':null!=g.items?(m=[],"function"==typeof g.items?m=g.items(g):Array.isArray(g.items)&&(m=g.items),f="<span></span>",c='<tr style="'+(g.expanded?"":"display: none")+'">     <td colspan="3">'+y(m,!0,g.expanded,l)+"</td><tr>"):(null!=g.count&&(f+="<span>"+g.count+"</span>"),null!=g.hotkey&&(f+='<span class="hotkey">'+g.hotkey+"</span>")),o+='<tr index="'+l+'" style="'+(g.style||"")+'" '+(g.tooltip?'title="'+w2utils.lang(g.tooltip)+'"':"")+' class="'+p+(w.index===l?" w2ui-selected":"")+(!0===g.disabled?" w2ui-disabled":"")+(""!==c?" has-sub-menu"+(g.expanded?" expanded":" collapsed"):"")+'"        onmousedown="if ('+(!0===g.disabled?"true":"false")+") return;               jQuery.fn.w2menuDown(event, "+l+",  "+n+');"        onclick="event.stopPropagation();                if ('+(!0===g.disabled?"true":"false")+") return;               jQuery.fn.w2menuClick(event, "+l+",  "+n+');">'+(t?"<td></td>":"")+d+'   <td class="menu-text" colspan="'+h+'">'+w2utils.lang(u)+'</td>   <td class="menu-count">'+f+"</td></tr>"+c,s++):o+='<tr><td colspan="3" class="menu-divider '+(""!=(m=u.replace(/^-+/g,""))?"divider-text":"")+'">   <div class="line">'+m+'</div>   <div class="text">'+m+"</div></td></tr>"),e[l]=g}return 0===s&&w.msgNoItems&&(o+='<tr><td style="padding: 13px; color: #999; text-align: center">'+w.msgNoItems+"</div></td></tr>"),o+="</tbody></table>"}},v.fn.w2color=function(n,e){var o,a,s,r,l,d,u,c,p,h,f,m,t=v(this),g=t[0];function i(e){e.color;for(var t,i='<div class="w2ui-colors" onmousedown="jQuery(this).parents(\'.w2ui-overlay\').data(\'keepOpen\', true)"><div class="w2ui-color-palette"><table cellspacing="5"><tbody>',n=0;n<a.length;n++){i+="<tr>";for(var s=0;s<a[n].length;s++)t="FFFFFF"===a[n][s]?";border: 1px solid #efefef":"",i+='<td>    <div class="w2ui-color '+(""===a[n][s]?"w2ui-no-color":"")+'" style="background-color: #'+a[n][s]+t+';"        name="'+a[n][s]+'" index="'+n+":"+s+'">'+(e.color==a[n][s]?"&#149;":"&#160;")+"    </div></td>",e.color==a[n][s]&&(o=[n,s]);i+="</tr>",n<2&&(i+='<tr><td style="height: 8px" colspan="8"></td></tr>')}return i=(i+="</tbody></table></div>")+'<div class="w2ui-color-advanced" style="display: none">   <div class="color-info">       <div class="color-preview-bg"><div class="color-preview"></div><div class="color-original"></div></div>       <div class="color-part">           <span>H</span> <input name="h" maxlength="3" max="360" tabindex="101">           <span>R</span> <input name="r" maxlength="3" max="255" tabindex="104">       </div>       <div class="color-part">           <span>S</span> <input name="s" maxlength="3" max="100" tabindex="102">           <span>G</span> <input name="g" maxlength="3" max="255" tabindex="105">       </div>       <div class="color-part">           <span>V</span> <input name="v" maxlength="3" max="100" tabindex="103">           <span>B</span> <input name="b" maxlength="3" max="255" tabindex="106">       </div>       <div class="color-part" style="margin: 30px 0px 0px 2px">           <span style="width: 40px">Opacity</span>            <input name="a" maxlength="5" max="1" style="width: 32px !important" tabindex="107">       </div>   </div>   <div class="palette" name="palette">       <div class="palette-bg"></div>       <div class="value1 move-x move-y"></div>   </div>   <div class="rainbow" name="rainbow">       <div class="value2 move-x"></div>   </div>   <div class="alpha" name="alpha">       <div class="alpha-bg"></div>       <div class="value2 move-x"></div>   </div></div>'+("<div class=\"w2ui-color-tabs\">   <div class=\"w2ui-color-tab selected\" onclick=\"jQuery(this).addClass('selected').next().removeClass('selected').parents('.w2ui-overlay').find('.w2ui-color-advanced').hide().parent().find('.w2ui-color-palette').show(); jQuery.fn._colorAdvanced = false; jQuery('#w2ui-overlay')[0].resize()\"><span class=\"w2ui-icon w2ui-icon-colors\"></span></div>   <div class=\"w2ui-color-tab\" onclick=\"jQuery(this).addClass('selected').prev().removeClass('selected').parents('.w2ui-overlay').find('.w2ui-color-advanced').show().parent().find('.w2ui-color-palette').hide(); jQuery.fn._colorAdvanced = true; jQuery('#w2ui-overlay')[0].resize()\"><span class=\"w2ui-icon w2ui-icon-settings\"></span></div>   <div style=\"padding: 8px; text-align: right;\">"+("string"==typeof e.html?e.html:"")+'</div></div></div><div style="clear: both; height: 0"></div>')}t.data("skipInit")?t.removeData("skipInit"):(o=[-1,-1],null==v.fn.w2colorPalette&&(v.fn.w2colorPalette=[["000000","333333","555555","777777","888888","999999","AAAAAA","CCCCCC","DDDDDD","EEEEEE","F7F7F7","FFFFFF"],["FF011B","FF9838","FFC300","FFFD59","86FF14","14FF7A","2EFFFC","2693FF","006CE7","9B24F4","FF21F5","FF0099"],["FFEAEA","FCEFE1","FCF4DC","FFFECF","EBFFD9","D9FFE9","E0FFFF","E8F4FF","ECF4FC","EAE6F4","FFF5FE","FCF0F7"],["F4CCCC","FCE5CD","FFF1C2","FFFDA1","D5FCB1","B5F7D0","BFFFFF","D6ECFF","CFE2F3","D9D1E9","FFE3FD","FFD9F0"],["EA9899","F9CB9C","FFE48C","F7F56F","B9F77E","84F0B1","83F7F7","B5DAFF","9FC5E8","B4A7D6","FAB9F6","FFADDE"],["E06666","F6B26B","DEB737","E0DE51","8FDB48","52D189","4EDEDB","76ACE3","6FA8DC","8E7CC3","E07EDA","F26DBD"],["CC0814","E69138","AB8816","B5B20E","6BAB30","27A85F","1BA8A6","3C81C7","3D85C6","674EA7","A14F9D","BF4990"],["99050C","B45F17","80650E","737103","395E14","10783D","13615E","094785","0A5394","351C75","780172","782C5A"]]),a=v.fn.w2colorPalette,null==(n="string"==typeof n?{color:n,transparent:!0}:n).onSelect&&null!=e&&(n.onSelect=e),n.transparent&&"333333"==a[0][1]&&(a[0].splice(1,1),a[0].push("")),n.transparent||"333333"==a[0][1]||(a[0].splice(1,0,"333333"),a[0].pop()),n.color&&(n.color=String(n.color).toUpperCase()),"string"==typeof n.color&&"#"===n.color.substr(0,1)&&(n.color=n.color.substr(1)),null==n.fireChange&&(n.fireChange=!0),0===v("#w2ui-overlay").length?v(g).w2overlay(i(n),n):(v("#w2ui-overlay .w2ui-colors").parent().html(i(n)),v("#w2ui-overlay").show()),v("#w2ui-overlay .w2ui-color").off(".w2color").on("mousedown.w2color",function(e){var t=v(e.originalEvent.target).attr("name");o=v(e.originalEvent.target).attr("index").split(":"),"INPUT"===g.tagName.toUpperCase()?(n.fireChange&&v(g).change(),v(g).next().find(">div").css("background-color",t)):v(g).data("_color",t),"function"==typeof n.onSelect&&n.onSelect(t)}).on("mouseup.w2color",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)}),v("#w2ui-overlay .color-original").off(".w2color").on("click.w2color",function(e){e=w2utils.parseColor(v(e.target).css("background-color"));null!=e&&(l=e,r=w2utils.rgb2hsv(l),d(r),u(),c())}),v("#w2ui-overlay input").off(".w2color").on("mousedown.w2color",function(e){v("#w2ui-overlay").data("keepOpen",!0),setTimeout(function(){v("#w2ui-overlay").data("keepOpen",!0)},10),e.stopPropagation()}).on("change.w2color",function(){var e=v(this),t=parseFloat(e.val()),i=parseFloat(e.attr("max")),i=(isNaN(t)&&(t=0),1<i&&(t=parseInt(t)),0<i&&i<t&&(e.val(i),t=i),t<0&&(e.val(0),t=0),e.attr("name")),e={};-1!==["r","g","b","a"].indexOf(i)?(l[i]=t,r=w2utils.rgb2hsv(l)):-1!==["h","s","v"].indexOf(i)&&(e[i]=t),d(e),u(),c()}),l=w2utils.parseColor(n.color),null==l&&(l={r:140,g:150,b:160,a:1},r=w2utils.rgb2hsv(l)),r=w2utils.rgb2hsv(l),d=function(e,t){null!=e.h&&(r.h=e.h),null!=e.s&&(r.s=e.s),null!=e.v&&(r.v=e.v),null!=e.a&&(l.a=e.a,r.a=e.a);var e="rgba("+(l=w2utils.hsv2rgb(r)).r+","+l.g+","+l.b+","+l.a+")",i=[Number(l.r).toString(16).toUpperCase(),Number(l.g).toString(16).toUpperCase(),Number(l.b).toString(16).toUpperCase(),Math.round(255*Number(l.a)).toString(16).toUpperCase()];i.forEach(function(e,t){1===e.length&&(i[t]="0"+e)}),e=i[0]+i[1]+i[2]+i[3],1===l.a&&(e=i[0]+i[1]+i[2]),v("#w2ui-overlay .color-preview").css("background-color","#"+e),v("#w2ui-overlay input").each(function(e,t){t.name&&(null!=l[t.name]&&(t.value=l[t.name]),null!=r[t.name]&&(t.value=r[t.name]),"a"===t.name)&&(t.value=l.a)}),t?v("#w2ui-overlay .color-original").css("background-color","#"+e):("INPUT"===g.tagName.toUpperCase()?(v(g).val(e).data("skipInit",!0),n.fireChange&&v(g).change(),v(g).next().find(">div").css("background-color","#"+e)):v(g).data("_color",e),"function"==typeof n.onSelect&&n.onSelect(e))},u=function(){var e=v("#w2ui-overlay .palette .value1"),t=v("#w2ui-overlay .rainbow .value2"),i=v("#w2ui-overlay .alpha .value2"),n=parseInt(e.width())/2,s=parseInt(t.width())/2;e.css({left:150*r.s/100-n,top:125*(100-r.v)/100-n}),t.css("left",r.h/2.4-s),i.css("left",150*l.a-s)},c=function(){var e=w2utils.hsv2rgb(r.h,100,100),e=e.r+","+e.g+","+e.b;v("#w2ui-overlay .palette").css("background-image","linear-gradient(90deg, rgba("+e+",0) 0%, rgba("+e+",1) 100%)")},t=function(e){var t=v(this).find(".value1, .value2"),i=parseInt(t.width())/2;t.hasClass("move-x")&&t.css({left:e.offsetX-i+"px"}),t.hasClass("move-y")&&t.css({top:e.offsetY-i+"px"}),s={$el:t,x:e.pageX,y:e.pageY,width:t.parent().width(),height:t.parent().height(),left:parseInt(t.css("left")),top:parseInt(t.css("top"))},h(e),v("body").off(".w2color").on(m,h).on(f,p)},p=function(e){v("body").off(".w2color")},h=function(e){var t=s.$el,i=e.pageX-s.x,e=e.pageY-s.y,i=s.left+i,e=s.top+e,n=parseInt(t.width())/2,i=((i=i<-n?-n:i)>s.width-n&&(i=s.width-n),(e=e<-n?-n:e)>s.height-n&&(e=s.height-n),t.hasClass("move-x")&&t.css({left:i+"px"}),t.hasClass("move-y")&&t.css({top:e+"px"}),t.parent().attr("name")),e=parseInt(t.css("left"))+n,t=parseInt(t.css("top"))+n;"palette"===i&&d({s:Math.round(e/s.width*100),v:Math.round(100-t/s.height*100)}),"rainbow"===i&&(n=Math.round(2.4*e),d({h:n}),c()),"alpha"===i&&d({a:parseFloat(Number(e/150).toFixed(2))})},!0!==v.fn._colorAdvanced&&!0!==n.advanced||(v("#w2ui-overlay .w2ui-color-tabs :nth-child(2)").click(),v("#w2ui-overlay").removeData("keepOpen")),d({},!0),c(),u(),f="mouseup.w2color",m="mousemove.w2color",w2utils.isIOS&&(f="touchend.w2color",m="touchmove.w2color  "),v("#w2ui-overlay .palette").off(".w2color").on("mousedown.w2color",t),v("#w2ui-overlay .rainbow").off(".w2color").on("mousedown.w2color",t),v("#w2ui-overlay .alpha").off(".w2color").on("mousedown.w2color",t),g.nav=function(e){switch(e){case"up":o[0]--;break;case"down":o[0]++;break;case"right":o[1]++;break;case"left":o[1]--}return o[0]<0&&(o[0]=0),o[0]>a.length-2&&(o[0]=a.length-2),o[1]<0&&(o[1]=0),o[1]>a[0].length-1&&(o[1]=a[0].length-1),color=a[o[0]][o[1]],v(g).data("_color",color),color})}}(jQuery),function(v){function s(e){this.el=null,this.helpers={},this.type=e.type||"text",this.options=v.extend(!0,{},e),this.onSearch=e.onSearch||null,this.onRequest=e.onRequest||null,this.onLoad=e.onLoad||null,this.onError=e.onError||null,this.onClick=e.onClick||null,this.onAdd=e.onAdd||null,this.onNew=e.onNew||null,this.onRemove=e.onRemove||null,this.onMouseOver=e.onMouseOver||null,this.onMouseOut=e.onMouseOut||null,this.onIconClick=e.onIconClick||null,this.onScroll=e.onScroll||null,this.tmp={},delete this.options.type,delete this.options.onSearch,delete this.options.onRequest,delete this.options.onLoad,delete this.options.onError,delete this.options.onClick,delete this.options.onMouseOver,delete this.options.onMouseOut,delete this.options.onIconClick,delete this.options.onScroll,v.extend(!0,this,w2obj.field)}v.fn.w2field=function(n,e){var t;return 0!==this.length?0===arguments.length?v(this).data("w2field"):((n="string"==typeof(n="string"==typeof n&&"object"==typeof e?v.extend(!0,{},e,{type:n}):n)&&null==e?{type:n}:n)&&(n.type=String(n.type).toLowerCase()),this.each(function(e,t){var i=v(t).data("w2field");return null!=i&&(i.clear(),"clear"===n.type)?void 0:(i=new s(n),v.extend(i,{handlers:[]}),t&&(i.el=v(t)[0]),i.init(),v(t).data("w2field",i),i)})):(t=s.prototype)[n]?t[n].apply(t,Array.prototype.slice.call(arguments,1)):void 0},v.extend(s.prototype={custom:{},addType:function(e,t){return e=String(e).toLowerCase(),this.custom[e]=t,!0},removeType:function(e){return e=String(e).toLowerCase(),!!this.custom[e]&&(delete this.custom[e],!0)},init:function(){var e,t=this,i=this.options;if("function"==typeof this.custom[this.type])this.custom[this.type].call(this,i);else if(-1==["INPUT","TEXTAREA"].indexOf(this.el.tagName.toUpperCase()))console.log("ERROR: w2field could only be applied to INPUT or TEXTAREA.",this.el);else{switch(this.type){case"text":case"int":case"float":case"money":case"currency":case"percent":case"alphanumeric":case"bin":case"hex":e={min:null,max:null,step:1,autoFormat:!0,currencyPrefix:w2utils.settings.currencyPrefix,currencySuffix:w2utils.settings.currencySuffix,currencyPrecision:w2utils.settings.currencyPrecision,decimalSymbol:w2utils.settings.decimalSymbol,groupSymbol:w2utils.settings.groupSymbol,arrows:!1,keyboard:!0,precision:null,silent:!0,prefix:"",suffix:""},this.options=v.extend(!0,{},e,i),(i=this.options).numberRE=new RegExp("["+i.groupSymbol+"]","g"),i.moneyRE=new RegExp("["+i.currencyPrefix+i.currencySuffix+i.groupSymbol+"]","g"),i.percentRE=new RegExp("["+i.groupSymbol+"%]","g"),-1!==["text","alphanumeric","hex","bin"].indexOf(this.type)&&(i.arrows=!1,i.keyboard=!1),this.addPrefix(),this.addSuffix();break;case"color":e={prefix:"",suffix:'<div style="width: '+(parseInt(v(this.el).css("font-size"))||12)+'px">&#160;</div>',arrows:!1,keyboard:!1,advanced:null,transparent:!0},this.options=v.extend(!0,{},e,i),i=this.options,this.addPrefix(),this.addSuffix(),""!==v(this.el).val()&&setTimeout(function(){t.change()},1);break;case"date":e={format:w2utils.settings.dateFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:{},colored:{},blockWeekDays:null},this.options=v.extend(!0,{},e,i),i=this.options,null==v(this.el).attr("placeholder")&&v(this.el).attr("placeholder",i.format);break;case"time":e={format:w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",noMinutes:!1},this.options=v.extend(!0,{},e,i),i=this.options,null==v(this.el).attr("placeholder")&&v(this.el).attr("placeholder",i.format);break;case"datetime":e={format:w2utils.settings.dateFormat+" | "+w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:[],colored:{},placeholder:null,btn_now:!0,noMinutes:!1},this.options=v.extend(!0,{},e,i),i=this.options,null==v(this.el).attr("placeholder")&&v(this.el).attr("placeholder",i.placeholder||i.format);break;case"list":case"combo":if(e={items:[],selected:{},url:null,recId:null,recText:null,method:null,interval:350,postData:{},minLength:1,cacheMax:250,maxDropHeight:350,maxDropWidth:null,match:"begins",silent:!0,icon:null,iconStyle:"",align:"both",altRows:!0,onSearch:null,onRequest:null,onLoad:null,onError:null,onIconClick:null,renderDrop:null,compare:null,filter:!0,prefix:"",suffix:"",openOnFocus:!1,markSearch:!1},"function"==typeof i.items&&(i._items_fun=i.items),i.items=w2obj.field.prototype.normMenu.call(this,i.items),"list"===this.type){if(e.openOnFocus=!0,v(this.el).addClass("w2ui-select"),!v.isPlainObject(i.selected)&&Array.isArray(i.items))for(var n=0;n<i.items.length;n++){var s=i.items[n];if(s&&s.id===i.selected){i.selected=v.extend(!0,{},s);break}}this.watchSize()}i=v.extend({},e,i),this.options=i,v.isPlainObject(i.selected)||(i.selected={}),v(this.el).data("selected",i.selected),i.url&&(i.items=[],this.request(0)),"list"===this.type&&this.addFocus(),this.addPrefix(),this.addSuffix(),setTimeout(function(){t.refresh()},10),v(this.el).attr("autocapitalize","off").attr("autocomplete","off").attr("autocorrect","off").attr("spellcheck","false"),null!=i.selected.text&&v(this.el).val(i.selected.text);break;case"enum":"function"==typeof(i=v.extend({},e={items:[],selected:[],max:0,url:null,recId:null,recText:null,interval:350,method:null,postData:{},minLength:1,cacheMax:250,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,match:"contains",silent:!0,align:"both",altRows:!0,openOnFocus:!1,markSearch:!0,renderDrop:null,renderItem:null,compare:null,filter:!0,style:"",onSearch:null,onRequest:null,onLoad:null,onError:null,onClick:null,onAdd:null,onNew:null,onRemove:null,onMouseOver:null,onMouseOut:null,onScroll:null},i,{suffix:""})).items&&(i._items_fun=i.items),i.items=w2obj.field.prototype.normMenu.call(this,i.items),i.selected=w2obj.field.prototype.normMenu.call(this,i.selected),this.options=i,v.isArray(i.selected)||(i.selected=[]),v(this.el).data("selected",i.selected),i.url&&(i.items=[],this.request(0)),this.addSuffix(),this.addMulti(),this.watchSize();break;case"file":i=v.extend({},e={selected:[],max:0,maxSize:0,maxFileSize:0,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,readContent:!0,silent:!0,align:"both",altRows:!0,renderItem:null,style:"",onClick:null,onAdd:null,onRemove:null,onMouseOver:null,onMouseOut:null},i),this.options=i,v.isArray(i.selected)||(i.selected=[]),v(this.el).data("selected",i.selected),null==v(this.el).attr("placeholder")&&v(this.el).attr("placeholder",w2utils.lang("Attach files by dragging and dropping or Click to Select")),this.addMulti(),this.watchSize()}this.tmp={onChange:function(e){t.change.call(t,e)},onClick:function(e){t.click.call(t,e)},onFocus:function(e){t.focus.call(t,e)},onBlur:function(e){t.blur.call(t,e)},onKeydown:function(e){t.keyDown.call(t,e)},onKeyup:function(e){t.keyUp.call(t,e)},onKeypress:function(e){t.keyPress.call(t,e)}},v(this.el).addClass("w2field w2ui-input").data("w2field",this).on("change.w2field",this.tmp.onChange).on("click.w2field",this.tmp.onClick).on("focus.w2field",this.tmp.onFocus).on("blur.w2field",this.tmp.onBlur).on("keydown.w2field",this.tmp.onKeydown).on("keyup.w2field",this.tmp.onKeyup).on("keypress.w2field",this.tmp.onKeypress).css(w2utils.cssPrefix("box-sizing","border-box")),this.change(v.Event("change"))}},watchSize:function(){var e=this,t=v(e.el).data("tmp")||{};t.sizeTimer=setInterval(function(){0<v(e.el).parents("body").length?e.resize():clearInterval(t.sizeTimer)},200),v(e.el).data("tmp",t)},get:function(){var e=-1!==["list","enum","file"].indexOf(this.type)?v(this.el).data("selected"):v(this.el).val();return e},set:function(e,t){-1!==["list","enum","file"].indexOf(this.type)?(("list"!==this.type&&t?(null==v(this.el).data("selected")&&v(this.el).data("selected",[]),v(this.el).data("selected").push(e),v(this.el)):(t="enum"===this.type?[e]:e,v(this.el).data("selected",t))).trigger("input").change(),this.refresh()):v(this.el).val(e)},setIndex:function(e,t){if(-1!==["list","enum"].indexOf(this.type)){var i=this.options.items;if(i&&i[e])return("list"!==this.type&&t?(null==v(this.el).data("selected")&&v(this.el).data("selected",[]),v(this.el).data("selected").push(i[e]),v(this.el)):(t="enum"===this.type?[i[e]]:i[e],v(this.el).data("selected",t))).trigger("input").change(),this.refresh(),!0}return!1},clear:function(){var e=this.options,e=(-1!==["money","currency"].indexOf(this.type)&&v(this.el).val(v(this.el).val().replace(e.moneyRE,"")),"percent"===this.type&&v(this.el).val(v(this.el).val().replace(/%/g,"")),"list"===this.type&&v(this.el).removeClass("w2ui-select"),this.type="clear",v(this.el).data("tmp"));if(this.tmp){for(var t in null!=e&&(v(this.el).height("auto"),e&&e["old-padding-left"]&&v(this.el).css("padding-left",e["old-padding-left"]),e&&e["old-padding-right"]&&v(this.el).css("padding-right",e["old-padding-right"]),e&&e["old-background-color"]&&v(this.el).css("background-color",e["old-background-color"]),e&&e["old-border-color"]&&v(this.el).css("border-color",e["old-border-color"]),clearInterval(e.sizeTimer)),v(this.el).val(this.clean(v(this.el).val())).removeClass("w2field").removeData().off(".w2field"),this.helpers)v(this.helpers[t]).remove();this.helpers={}}},refresh:function(){var a=this,i=this.options,r=v(this.el).data("selected"),e=(new Date).getTime();if(-1!==["list"].indexOf(this.type)&&(v(a.el).parent().css("white-space","nowrap"),a.helpers.prefix&&a.helpers.prefix.hide(),setTimeout(function(){var t;a.helpers.focus&&(!v.isEmptyObject(r)&&i.icon?i.prefix='<span class="w2ui-icon '+i.icon+'"style="cursor: pointer; font-size: 14px; display: inline-block; margin-top: -1px; color: #7F98AD;'+i.iconStyle+'"></span>':i.prefix="",a.addPrefix(),t=a.helpers.focus.find("input"),""===v(t).val()?(v(t).css("text-indent","-9999em").prev().css("opacity",0),v(a.el).val(r&&null!=r.text?w2utils.lang(r.text):"")):(v(t).css("text-indent",0).prev().css("opacity",1),v(a.el).val(""),setTimeout(function(){a.helpers.prefix&&a.helpers.prefix.hide();var e="position: absolute; opacity: 0; margin: 4px 0px 0px 2px; background-position: left !important;";i.icon?(v(t).css("margin-left","17px"),v(a.helpers.focus).find(".icon-search").attr("style",e+"width: 11px !important; opacity: 1; display: block")):(v(t).css("margin-left","0px"),v(a.helpers.focus).find(".icon-search").attr("style",e+"width: 0px !important; opacity: 0; display: none"))},1)),v(a.el).prop("readonly")||v(a.el).prop("disabled")?setTimeout(function(){v(a.helpers.prefix).css("opacity","0.6"),v(a.helpers.suffix).css("opacity","0.6")},1):setTimeout(function(){v(a.helpers.prefix).css("opacity","1"),v(a.helpers.suffix).css("opacity","1")},1))},1)),-1!==["enum","file"].indexOf(this.type)){var t="";if(r)for(var n=0;n<r.length;n++){var s=r[n],o="",o="function"==typeof i.renderItem?i.renderItem(s,n,'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+n+'">&#160;&#160;</div>'):'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+n+'">&#160;&#160;</div>'+("enum"===a.type?s.text:s.name+'<span class="file-size"> - '+w2utils.formatSize(s.size)+"</span>");t+='<li index="'+n+'" style="max-width: '+parseInt(i.maxWidth)+"px; "+(s.style||"")+'">'+o+"</li>"}var l=a.helpers.multi,d=l.find("ul"),d=(l.attr("style",l.attr("style")+";"+i.style),v(a.el).css("z-index","-1"),v(a.el).prop("readonly")||v(a.el).prop("disabled")?setTimeout(function(){l[0].scrollTop=0,l.addClass("w2ui-readonly").find("li").css("opacity","0.9").parent().find("li.nomouse").hide().find("input").prop("readonly",!0).parents("ul").find(".w2ui-list-remove").hide()},1):setTimeout(function(){l.removeClass("w2ui-readonly").find("li").css("opacity","1").parent().find("li.nomouse").show().find("input").prop("readonly",!1).parents("ul").find(".w2ui-list-remove").show()},1),l.find(".w2ui-enum-placeholder").remove(),d.find("li").not("li.nomouse").remove(),""!==t?d.prepend(t):null!=v(a.el).attr("placeholder")&&""===l.find("input").val()&&(d="padding-top: "+v(this.el).css("padding-top")+";padding-left: "+v(this.el).css("padding-left")+"; box-sizing: "+v(this.el).css("box-sizing")+"; line-height: "+v(this.el).css("line-height")+"; font-size: "+v(this.el).css("font-size")+"; font-family: "+v(this.el).css("font-family")+"; ",l.prepend('<div class="w2ui-enum-placeholder" style="'+d+'">'+v(a.el).attr("placeholder")+"</div>")),l.off("scroll.w2field").on("scroll.w2field",function(e){e=a.trigger({phase:"before",type:"scroll",target:a.el,originalEvent:e});!0!==e.isCancelled&&a.trigger(v.extend(e,{phase:"after"}))}).find("li").data("mouse","out").on("click",function(e){var t,i,n,s="LI"===e.target.tagName.toUpperCase()?e.target:v(e.target).parents("LI"),o=r[v(s).attr("index")];v(s).hasClass("nomouse")||(e.stopPropagation(),v(e.target).hasClass("w2ui-list-remove")?v(a.el).prop("readonly")||v(a.el).prop("disabled")||!0!==(t=a.trigger({phase:"before",type:"remove",target:a.el,originalEvent:e.originalEvent,item:o})).isCancelled&&(v().w2overlay(),r.splice(v(e.target).attr("index"),1),v(a.el).trigger("input").trigger("change"),v(e.target).parent().fadeOut("fast"),setTimeout(function(){a.refresh(),a.trigger(v.extend(t,{phase:"after"}))},300)):!0!==(t=a.trigger({phase:"before",type:"click",target:a.el,originalEvent:e.originalEvent,item:o})).isCancelled&&("file"===a.type&&(e="",/image/i.test(o.type)&&(e='<div style="padding: 3px;">    <img src="'+(o.content?"data:"+o.type+";base64,"+o.content:"")+'" style="max-width: 300px;"         onload="var w = jQuery(this).width(); var h = jQuery(this).height();             if (w < 300 & h < 300) return;             if (w >= h && w > 300) jQuery(this).width(300);            if (w < h && h > 300) jQuery(this).height(300);"        onerror="this.style.display = \'none\'"    ></div>'),n='style="padding: 3px"',e+='<div style="padding: 8px;">    <table cellpadding="2"><tbody>    <tr><td '+(i='style="padding: 3px; text-align: right; color: #777;"')+">"+w2utils.lang("Name")+":</td><td "+n+">"+o.name+"</td></tr>    <tr><td "+i+">"+w2utils.lang("Size")+":</td><td "+n+">"+w2utils.formatSize(o.size)+"</td></tr>    <tr><td "+i+">"+w2utils.lang("Type")+":</td><td "+n+'>        <span style="width: 200px; display: block-inline; overflow: hidden; text-overflow: ellipsis; white-space: nowrap="nowrap";">'+o.type+"</span>    </td></tr>    <tr><td "+i+">"+w2utils.lang("Modified")+":</td><td "+n+">"+w2utils.date(o.modified)+"</td></tr>    </tbody></table></div>",v("#w2ui-overlay").remove(),v(s).w2overlay(e)),a.trigger(v.extend(t,{phase:"after"}))))}).on("mouseover",function(e){var t="LI"===e.target.tagName.toUpperCase()?e.target:v(e.target).parents("LI");if(!v(t).hasClass("nomouse")){if("out"===v(t).data("mouse")){var i=r[v(e.target).attr("index")],e=a.trigger({phase:"before",type:"mouseOver",target:a.el,originalEvent:e.originalEvent,item:i});if(!0===e.isCancelled)return;a.trigger(v.extend(e,{phase:"after"}))}v(t).data("mouse","over")}}).on("mouseout",function(t){var i="LI"===t.target.tagName.toUpperCase()?t.target:v(t.target).parents("LI");v(i).hasClass("nomouse")||(v(i).data("mouse","leaving"),setTimeout(function(){var e;"leaving"===v(i).data("mouse")&&(v(i).data("mouse","out"),e=r[v(t.target).attr("index")],!0!==(e=a.trigger({phase:"before",type:"mouseOut",target:a.el,originalEvent:t.originalEvent,item:e})).isCancelled)&&a.trigger(v.extend(e,{phase:"after"}))},0))}),v(this.el).height("auto"),v(l).find("> div.w2ui-multi-items").height()+2*w2utils.getSize(l,"+height")),u=((d=d<26?26:d)>i.maxHeight&&(d=i.maxHeight),0<l.length&&(l[0].scrollTop=1e3),w2utils.getSize(v(this.el),"height")-2);d<u&&(d=u),v(l).css({height:d+"px",overflow:d==i.maxHeight?"auto":"hidden"}),d<i.maxHeight&&v(l).prop("scrollTop",0),v(this.el).css({height:d+0+"px"}),"enum"===a.type&&(u=a.helpers.multi.find("input")).width(8*(u.val().length+2)+"px")}return(new Date).getTime()-e},reset:function(){var e=this.type;this.clear(),this.type=e,this.init()},resize:function(){var e,t,i,n=this,s=v(n.el).width(),o=v(n.el).height();n.tmp.current_width==s&&0<o||(o=this.helpers.focus,e=this.helpers.multi,t=this.helpers.suffix,i=this.helpers.prefix,o&&o.width(v(n.el).width()),e&&(o=w2utils.getSize(n.el,"width")-parseInt(v(n.el).css("margin-left"),10)-parseInt(v(n.el).css("margin-right"),10),v(e).width(o)),t&&(n.options.suffix='<div class="arrow-down" style="margin-top: '+(parseInt(v(n.el).height())-6)/2+'px;"></div>',n.addSuffix()),i&&n.addPrefix(),n.tmp.current_width=s)},clean:function(e){var t;return"number"!=typeof e&&(t=this.options,e=String(e).trim(),-1!==["int","float","money","currency","percent"].indexOf(this.type))&&("string"==typeof e&&(t.autoFormat&&-1!==["money","currency"].indexOf(this.type)&&(e=String(e).replace(t.moneyRE,"")),t.autoFormat&&"percent"===this.type&&(e=String(e).replace(t.percentRE,"")),e=(e=t.autoFormat&&-1!==["int","float"].indexOf(this.type)?String(e).replace(t.numberRE,""):e).replace(/\s+/g,"").replace(w2utils.settings.groupSymbol,"").replace(w2utils.settings.decimalSymbol,".")),parseFloat(e)==e&&(null!=t.min&&e<t.min&&(e=t.min,v(this.el).val(t.min)),null!=t.max)&&e>t.max&&(e=t.max,v(this.el).val(t.max)),e=""!==e&&w2utils.isFloat(e)?Number(e):""),e},format:function(e){var t=this.options;if(t.autoFormat&&""!==e)switch(this.type){case"money":case"currency":""!==(e=w2utils.formatNumber(e,t.currencyPrecision,t.groupSymbol))&&(e=t.currencyPrefix+e+t.currencySuffix);break;case"percent":""!==(e=w2utils.formatNumber(e,t.precision,t.groupSymbol))&&(e+="%");break;case"float":e=w2utils.formatNumber(e,t.precision,t.groupSymbol);break;case"int":e=w2utils.formatNumber(e,0,t.groupSymbol)}return e},change:function(e){var t=this,i=t.options;if(-1!==["int","float","money","currency","percent"].indexOf(this.type)){var n=v(this.el).val(),s=this.format(this.clean(v(this.el).val()));if(""!==n&&n!=s)return v(this.el).val(s).trigger("input").change(),e.stopPropagation(),e.preventDefault(),!1}"color"===this.type&&("rgb"!==(n=v(this.el).val()).substr(0,3).toLowerCase()&&(n="#"+n,8!==(s=v(this.el).val().length))&&6!==s&&3!==s&&(n=""),v(this.el).next().find("div").css("background-color",n),v(this.el).hasClass("has-focus"))&&!0!==v(this.el).data("skipInit")&&this.updateOverlay(),-1!==["list","enum","file"].indexOf(this.type)&&(t.refresh(),setTimeout(function(){t.refresh()},5)),-1!==["date","time","datetime"].indexOf(this.type)&&(e=parseInt(t.el.value),w2utils.isInt(t.el.value))&&3e3<e&&("time"===this.type&&v(t.el).val(w2utils.formatTime(new Date(e),i.format)).trigger("input").change(),"date"===this.type&&v(t.el).val(w2utils.formatDate(new Date(e),i.format)).trigger("input").change(),"datetime"===this.type)&&v(t.el).val(w2utils.formatDateTime(new Date(e),i.format)).trigger("input").change()},click:function(e){e.stopPropagation(),-1===["list","combo","enum"].indexOf(this.type)||v(this.el).hasClass("has-focus")||this.focus(e),-1!==["date","time","color","datetime"].indexOf(this.type)&&this.updateOverlay()},focus:function(e){var t=this;if(v(t.el).addClass("has-focus"),-1!==["color","date","time","datetime"].indexOf(t.type)){if(v(t.el).prop("readonly")||v(t.el).prop("disabled"))return;0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide(),setTimeout(function(){t.updateOverlay()},150)}if(-1!==["list","combo","enum"].indexOf(t.type)){if(v(t.el).prop("readonly")||v(t.el).prop("disabled"))return;0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide(),t.resize(),setTimeout(function(){"list"===t.type&&v(t.el).is(":focus")?v(t.helpers.focus).find("input").focus():(t.search(),setTimeout(function(){t.updateOverlay()},1))},1),"function"==typeof t.options._items_fun&&(t.options.items=w2obj.field.prototype.normMenu.call(this,t.options._items_fun))}"file"===t.type&&v(t.helpers.multi).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"})},blur:function(e){var t,i=this,n=i.options,s=v(i.el).val().trim(),o=v("#w2ui-overlay");v(i.el).removeClass("has-focus"),-1!==["color","date","time","list","combo","enum","datetime"].indexOf(i.type)&&(t=window.setTimeout(function(){!0!==o.data("keepOpen")&&o.hide()},0),v(".menu",o).one("focus",function(){clearTimeout(t),v(this).one("focusout",function(e){o.hide()})})),-1===["int","float","money","currency","percent"].indexOf(i.type)||""===s||i.checkType(s)||(v(i.el).val("").trigger("input").change(),!1===n.silent&&(v(i.el).w2tag("Not a valid number"),setTimeout(function(){v(i.el).w2tag("")},3e3))),-1!==["date","time","datetime"].indexOf(i.type)&&(""===s||i.inRange(i.el.value)?"date"!==i.type||""===s||w2utils.isDate(i.el.value,n.format)?"time"!==i.type||""===s||w2utils.isTime(i.el.value)?"datetime"!==i.type||""===s||w2utils.isDateTime(i.el.value,n.format)||(v(i.el).val("").removeData("selected").trigger("input").change(),!1===n.silent&&(v(i.el).w2tag("Not a valid date"),setTimeout(function(){v(i.el).w2tag("")},3e3))):(v(i.el).val("").removeData("selected").trigger("input").change(),!1===n.silent&&(v(i.el).w2tag("Not a valid time"),setTimeout(function(){v(i.el).w2tag("")},3e3))):(v(i.el).val("").removeData("selected").trigger("input").change(),!1===n.silent&&(v(i.el).w2tag("Not a valid date"),setTimeout(function(){v(i.el).w2tag("")},3e3))):(v(i.el).val("").removeData("selected").trigger("input").change(),!1===n.silent&&(v(i.el).w2tag("Not in range"),setTimeout(function(){v(i.el).w2tag("")},3e3)))),"enum"===i.type&&v(i.helpers.multi).find("input").val("").width(20),"file"===i.type&&v(i.helpers.multi).css({outline:"none"})},keyPress:function(e){var t=this;t.options;if(-1!==["int","float","money","currency","percent","hex","bin","color","alphanumeric"].indexOf(t.type)){if(e.metaKey||e.ctrlKey||e.altKey||e.charCode!=e.keyCode&&0<e.keyCode)return;var i=String.fromCharCode(e.charCode);if(!t.checkType(i,!0)&&13!=e.keyCode)return e.preventDefault(),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1}-1!==["date","time","datetime"].indexOf(t.type)&&9!==e.keyCode&&setTimeout(function(){t.updateOverlay()},1)},keyDown:function(e,t){var i=this,n=i.options,s=e.keyCode||t&&t.keyCode,o=!1;if(-1!==["int","float","money","currency","percent"].indexOf(i.type)){if(!n.keyboard||v(i.el).prop("readonly")||v(i.el).prop("disabled"))return;var a,r=parseFloat(v(i.el).val().replace(n.moneyRE,""))||0,l=n.step;switch((e.ctrlKey||e.metaKey)&&(l=10),s){case 38:e.shiftKey||(a=r+l<=n.max||null==n.max?Number((r+l).toFixed(12)):n.max,v(i.el).val(a).trigger("input").change(),o=!0);break;case 40:e.shiftKey||(a=r-l>=n.min||null==n.min?Number((r-l).toFixed(12)):n.min,v(i.el).val(a).trigger("input").change(),o=!0)}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0))}if("date"===i.type){if(!n.keyboard||v(i.el).prop("readonly")||v(i.el).prop("disabled"))return;var d=864e5,l=1;switch((e.ctrlKey||e.metaKey)&&(l=10),(c=w2utils.isDate(v(i.el).val(),n.format,!0))||(c=new Date,d=0),s){case 38:e.shiftKey||(p=w2utils.formatDate(c.getTime()+d,n.format),10==l&&(p=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),n.format)),v(i.el).val(p).trigger("input").change(),o=!0);break;case 40:e.shiftKey||(p=w2utils.formatDate(c.getTime()-d,n.format),10==l&&(p=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),n.format)),v(i.el).val(p).trigger("input").change(),o=!0)}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length),i.updateOverlay()},0))}if("time"===i.type){if(!n.keyboard||v(i.el).prop("readonly")||v(i.el).prop("disabled"))return;var l=e.ctrlKey||e.metaKey?60:1,r=v(i.el).val(),u=i.toMin(r)||i.toMin((new Date).getHours()+":"+((new Date).getMinutes()-1));switch(s){case 38:e.shiftKey||(u+=l,o=!0);break;case 40:e.shiftKey||(u-=l,o=!0)}o&&(v(i.el).val(i.fromMin(u)).trigger("input").change(),e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0))}if("datetime"===i.type){if(!n.keyboard||v(i.el).prop("readonly")||v(i.el).prop("disabled"))return;var c,p,d=864e5,l=1,t=((e.ctrlKey||e.metaKey)&&(l=10),v(i.el).val());switch((c=w2utils.isDateTime(t,this.options.format,!0))||(c=new Date,d=0),s){case 38:e.shiftKey||(p=w2utils.formatDateTime(c.getTime()+d,n.format),10==l&&(p=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),n.format)),v(i.el).val(p).trigger("input").change(),o=!0);break;case 40:e.shiftKey||(p=w2utils.formatDateTime(c.getTime()-d,n.format),10==l&&(p=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),n.format)),v(i.el).val(p).trigger("input").change(),o=!0)}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length),i.updateOverlay()},0))}if("color"===i.type){if(v(i.el).prop("readonly")||v(i.el).prop("disabled"))return;if((e.ctrlKey||e.metaKey)&&!e.shiftKey){var h=null;switch(s){case 38:h="up";break;case 40:h="down";break;case 39:h="right";break;case 37:h="left"}i.el.nav&&null!=h&&(t=i.el.nav(h),v(i.el).val(t).trigger("input").change(),e.preventDefault())}}if(-1!==["list","combo","enum"].indexOf(i.type)&&!v(i.el).prop("readonly")&&!v(i.el).prop("disabled")){var f=v(i.el).data("selected"),m=v(i.el),g=!1;switch(-1!==["list","enum"].indexOf(i.type)&&("list"===i.type&&(m=v(i.helpers.focus).find("input")),"enum"===i.type&&(m=v(i.helpers.multi).find("input")),-1==[37,38,39,40].indexOf(s)&&setTimeout(function(){i.refresh()},1),86==e.keyCode)&&(e.ctrlKey||e.metaKey)&&setTimeout(function(){i.refresh(),i.search(),i.request()},50),s){case 27:"list"===i.type&&(""!==m.val()&&m.val(""),e.stopPropagation());break;case 37:case 39:break;case 13:if(0!==v("#w2ui-overlay").length){var w=n.items[n.index];if("enum"===i.type){if(null!=w){if(!0===(y=i.trigger({phase:"before",type:"add",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;w=y.item,f.length>=n.max&&0<n.max&&f.pop(),delete w.hidden,delete i.tmp.force_open,f.push(w),v(i.el).trigger("input").change(),m.val("").width(20),i.refresh()}else{if(w={id:m.val(),text:m.val()},!0===(y=i.trigger({phase:"before",type:"new",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;w=y.item,"function"==typeof i.onNew&&(f.length>=n.max&&0<n.max&&f.pop(),delete i.tmp.force_open,f.push(w),v(i.el).trigger("input").change(),m.val("").width(20),i.refresh())}i.trigger(v.extend(y,{phase:"after"}))}else w&&v(i.el).data("selected",w).val(w.text).trigger("input").change(),""===v(i.el).val()&&v(i.el).data("selected")&&v(i.el).removeData("selected").val("").trigger("input").change(),"list"===i.type&&(m.val(""),i.refresh()),i.tmp.force_hide=!0}break;case 8:case 46:if("enum"===i.type&&8===s&&""===m.val()&&0<f.length){var y,w=f[f.length-1];if(!0===(y=i.trigger({phase:"before",type:"remove",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;f.pop(),v(i.el).trigger("input").trigger("change"),i.refresh(),i.trigger(v.extend(y,{phase:"after"}))}"list"===i.type&&""===m.val()&&(v(i.el).data("selected",{}).trigger("input").change(),i.refresh());break;case 38:for(n.index=w2utils.isInt(n.index)?parseInt(n.index):0,n.index--;0<n.index&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index--;if(0===n.index&&(n.items[n.index].hidden||n.items[n.index].disabled))for(;n.items[n.index]&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index++;g=!0;break;case 40:for(n.index=w2utils.isInt(n.index)?parseInt(n.index):-1,n.index++;n.index<n.items.length-1&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index++;if(n.index==n.items.length-1&&(n.items[n.index].hidden||n.items[n.index].disabled))for(;n.items[n.index]&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index--;""===m.val()&&0===v("#w2ui-overlay").length?i.tmp.force_open=!0:g=!0}g?(n.index<0&&(n.index=0),n.index>=n.items.length&&(n.index=n.items.length-1),i.updateOverlay(g),e.preventDefault(),setTimeout(function(){var e;"enum"===i.type||"list"===i.type?(e=m.get(0)).setSelectionRange(e.value.length,e.value.length):i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0)):"enum"===i.type&&m.width(8*(m.val().length+2)+"px")}},keyUp:function(e){var t,i;-1===["list","combo","enum"].indexOf(this.type)||v(this.el).prop("readonly")||v(this.el).prop("disabled")||-1==[16,17,18,20,37,39,91].indexOf(e.keyCode)&&(0===(t=v(this.helpers.focus).find("input")).length&&(t=v(this.el)),!0!==(i=this.trigger({phase:"before",type:"search",originalEvent:e,target:t,search:t.val()})).isCancelled)&&(this.tmp.force_hide||this.request(),1==t.val().length&&this.refresh(),0!==v("#w2ui-overlay").length&&-1!=[38,40].indexOf(e.keyCode)||this.search(),this.trigger(v.extend(i,{phase:"after"})))},clearCache:function(){this.options.items=[],this.tmp.xhr_loading=!1,this.tmp.xhr_search="",this.tmp.xhr_total=-1},request:function(e){var t,a=this,r=this.options,l=v(a.el).val()||"";if(r.url)if("enum"===a.type&&(l=0===(t=v(a.helpers.multi).find("input")).length?"":t.val()),"list"===a.type&&(t=v(a.helpers.focus).find("input"),l=0===t.length?"":t.val()),0!==r.minLength&&l.length<r.minLength)r.items=[],this.updateOverlay();else if(null==e&&(e=r.interval),null==a.tmp.xhr_search&&(a.tmp.xhr_search=""),null==a.tmp.xhr_total&&(a.tmp.xhr_total=-1),r.url&&(0===r.items.length&&0!==a.tmp.xhr_total||a.tmp.xhr_total==r.cacheMax&&l.length>a.tmp.xhr_search.length||l.length>=a.tmp.xhr_search.length&&l.substr(0,a.tmp.xhr_search.length)!==a.tmp.xhr_search||l.length<a.tmp.xhr_search.length)){if(a.tmp.xhr)try{a.tmp.xhr.abort()}catch(e){}a.tmp.xhr_loading=!0,a.search(),clearTimeout(a.tmp.timeout),a.tmp.timeout=setTimeout(function(){var e,t=r.url,o={search:l,max:r.cacheMax},t=(v.extend(o,r.postData),a.trigger({phase:"before",type:"request",search:l,target:a.el,url:t,postData:o}));!0!==t.isCancelled&&(e={type:"GET",url:t.url,data:o=t.postData,dataType:"JSON"},r.method&&(e.type=r.method),"JSON"===w2utils.settings.dataType&&(e.type="POST",e.data=JSON.stringify(e.data),e.contentType="application/json"),"HTTPJSON"===w2utils.settings.dataType&&(e.data={request:JSON.stringify(e.data)}),null!=r.method&&(e.type=r.method),a.tmp.xhr=v.ajax(e).done(function(e,t,i){var n,s,i=a.trigger({phase:"before",type:"load",target:a.el,search:o.search,data:e,xhr:i});!0!==i.isCancelled&&(null==(e="string"==typeof(e=i.data)?JSON.parse(e):e).records&&null!=e.items&&(e.records=e.items,delete e.items),"success"===e.status&&null==e.records&&(e.records=[]),"success"===e.status&&Array.isArray(e.records)?(e.records.length>r.cacheMax&&e.records.splice(r.cacheMax,1e5),null==r.recId&&null!=r.recid&&(r.recId=r.recid),(r.recId||r.recText)&&e.records.forEach(function(e){"string"==typeof r.recId&&(e.id=e[r.recId]),"function"==typeof r.recId&&(e.id=r.recId(e)),"string"==typeof r.recText&&(e.text=e[r.recText]),"function"==typeof r.recText&&(e.text=r.recText(e))}),a.tmp.xhr_loading=!1,a.tmp.xhr_search=l,a.tmp.xhr_total=e.records.length,a.tmp.lastError="",r.items=a.normMenu(e.records),""===l&&0===e.records.length?a.tmp.emptySet=!0:a.tmp.emptySet=!1,(n=v(a.el).data("find_selected"))&&(Array.isArray(n)?(s=[],n.forEach(function(t){var i=!1;r.items.forEach(function(e){(e.id==t||t&&t.id==e.id)&&(s.push(v.extend(!0,{},e)),i=!0)}),i||s.push(t)})):(s=n,r.items.forEach(function(e){(e.id==n||n&&n.id==e.id)&&(s=e)})),v(a.el).data("selected",s).removeData("find_selected").trigger("input").change()),a.search(),a.trigger(v.extend(i,{phase:"after"}))):console.log("ERROR: server did not return proper structure. It should return",{status:"success",records:[{id:1,text:"item"}]}))}).fail(function(e,t,i){var n,i={status:t,error:i,rawResponseText:e.responseText},i=a.trigger({phase:"before",type:"error",target:a.el,search:l,error:i,xhr:e});if(!0!==i.isCancelled){if("abort"!==t){try{n=v.parseJSON(e.responseText)}catch(e){}console.log("ERROR: Server communication failed.","\n   EXPECTED:",{status:"success",records:[{id:1,text:"item"}]},"\n         OR:",{status:"error",message:"error message"},"\n   RECEIVED:","object"==typeof n?n:e.responseText)}a.tmp.xhr_loading=!1,a.tmp.xhr_search=l,a.tmp.xhr_total=0,a.tmp.emptySet=!0,a.tmp.lastError=i.error||"Server communication failed",r.items=[],a.clearCache(),a.search(),a.updateOverlay(!1),a.trigger(v.extend(i,{phase:"after"}))}}),a.trigger(v.extend(t,{phase:"after"})))},e)}},search:function(){var e=this,t=this.options,i=v(e.el).val(),n=e.el,s=[],o=v(e.el).data("selected");if("enum"===e.type)for(var a in n=v(e.helpers.multi).find("input"),i=n.val(),o)o[a]&&s.push(o[a].id);else if("list"===e.type)for(var a in n=v(e.helpers.focus).find("input"),i=n.val(),o)o[a]&&s.push(o[a].id);var r=t.items;if(!0!==e.tmp.xhr_loading){for(var l=0,d=0;d<r.length;d++){var u=r[d];if(null!=t.compare)"function"==typeof t.compare&&(u.hidden=!1===t.compare.call(this,u,i));else{var c="",p="";-1!==["is","begins"].indexOf(t.match)&&(c="^"),-1!==["is","ends"].indexOf(t.match)&&(p="$");try{new RegExp(c+i+p,"i").test(u.text)||"..."===u.text?u.hidden=!1:u.hidden=!0}catch(e){}}!1===t.filter&&(u.hidden=!1),"enum"===e.type&&-1!==v.inArray(u.id,s)&&(u.hidden=!0),!0!==u.hidden&&(l++,delete u.hidden)}for(t.index=-1;r[t.index]&&r[t.index].hidden;)t.index++;l<=0&&(t.index=-1),t.spinner=!1,e.updateOverlay(),setTimeout(function(){var e=v("#w2ui-overlay").html()||"";t.markSearch&&-1!==e.indexOf("$.fn.w2menuHandler")&&v("#w2ui-overlay").w2marker(i)},1)}else r.splice(0,t.cacheMax),t.spinner=!0,e.updateOverlay()},updateOverlay:function(e){var s,i,t,n,o,a=this,r=this.options;if("color"===this.type){if(v(a.el).prop("readonly")||v(a.el).prop("disabled"))return;v(this.el).w2color({color:v(this.el).val(),transparent:r.transparent,advanced:r.advanced},function(e){null!=e&&v(a.el).val(e).trigger("input").change()})}if("date"===this.type){if(v(a.el).prop("readonly")||v(a.el).prop("disabled"))return;0===v("#w2ui-overlay").length&&v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(e){w2utils.isIE&&v(".w2ui-calendar").on("mousedown",function(e){e=v(e.target);1===e.length&&"w2ui-jump-year"===e[0].id&&v("#w2ui-overlay").data("keepOpen",!0)})}}),(d=w2utils.isDate(v(a.el).val(),a.options.format,!0))&&(t=d.getMonth()+1,n=d.getFullYear()),!function i(e,t){v("#w2ui-overlay > div > div").html(a.getMonthHTML(e,t,v(a.el).val())),v("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var e,t;v(this).next().hasClass("w2ui-calendar-jump")?v(this).next().remove():(v(this).after('<div class="w2ui-calendar-jump" style=""></div>'),v(this).next().hide().html(a.getYearHTML()).fadeIn(200),setTimeout(function(){v("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){v(this).hasClass("w2ui-jump-month")&&(v(this).parent().find(".w2ui-jump-month").removeClass("selected"),v(this).addClass("selected"),t=v(this).attr("name")),v(this).hasClass("w2ui-jump-year")&&(v(this).parent().find(".w2ui-jump-year").removeClass("selected"),v(this).addClass("selected"),e=v(this).attr("name")),null!=e&&null!=t&&(v("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){i(parseInt(t)+1,e)},100))}),v("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),v("#w2ui-overlay .w2ui-date").on("mousedown",function(){var e=v(this).attr("date");v(a.el).val(e).trigger("input").change(),v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"})}).on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)}),v("#w2ui-overlay .previous").on("mousedown",function(){var e=a.options.current.split("/");e[0]=parseInt(e[0])-1,i(e[0],e[1])}),v("#w2ui-overlay .next").on("mousedown",function(){var e=a.options.current.split("/");e[0]=parseInt(e[0])+1,i(e[0],e[1])})}(t,n)}if("time"===this.type){if(v(a.el).prop("readonly")||v(a.el).prop("disabled"))return;0===v("#w2ui-overlay").length&&v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#fff"}});var l="h24"===this.options.format;v("#w2ui-overlay > div").html(a.getHourHTML()),v("#w2ui-overlay .w2ui-time").on("mousedown",function(e){v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var t=v(this).attr("hour");v(a.el).val((12<t&&!l?t-12:t)+":00"+(l?"":t<12?" am":" pm")).trigger("input").change()}),null==this.options.noMinutes||!1===this.options.noMinutes?v("#w2ui-overlay .w2ui-time").on("mouseup",function(){var t=v(this).attr("hour");0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide(),v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),v("#w2ui-overlay > div").html(a.getMinHTML(t)),v("#w2ui-overlay .w2ui-time").on("mousedown",function(){v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var e=v(this).attr("min");v(a.el).val((12<t&&!l?t-12:t)+":"+(e<10?0:"")+e+(l?"":t<12?" am":" pm")).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):v("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}if("datetime"===this.type){if(v(a.el).prop("readonly")||v(a.el).prop("disabled"))return;0<v("#w2ui-overlay .w2ui-time").length&&v("#w2ui-overlay")[0].hide(),0===v("#w2ui-overlay").length&&v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(e){w2utils.isIE&&v(".w2ui-calendar").on("mousedown",function(e){e=v(e.target);1===e.length&&"w2ui-jump-year"===e[0].id&&v("#w2ui-overlay").data("keepOpen",!0)})}});(d=w2utils.isDateTime(v(a.el).val(),a.options.format,!0))&&(t=d.getMonth()+1,n=d.getFullYear());var d,u=null;!function i(e,t){v("#w2ui-overlay > div > div").html(a.getMonthHTML(e,t,v(a.el).val())+(r.btn_now?'<div class="w2ui-calendar-now now">'+w2utils.lang("Current Date & Time")+"</div>":"")),v("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var e,t;v(this).next().hasClass("w2ui-calendar-jump")?v(this).next().remove():(v(this).after('<div class="w2ui-calendar-jump" style=""></div>'),v(this).next().hide().html(a.getYearHTML()).fadeIn(200),setTimeout(function(){v("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){v(this).hasClass("w2ui-jump-month")&&(v(this).parent().find(".w2ui-jump-month").removeClass("selected"),v(this).addClass("selected"),t=v(this).attr("name")),v(this).hasClass("w2ui-jump-year")&&(v(this).parent().find(".w2ui-jump-year").removeClass("selected"),v(this).addClass("selected"),e=v(this).attr("name")),null!=e&&null!=t&&(v("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){i(parseInt(t)+1,e)},100))}),v("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),v("#w2ui-overlay .w2ui-date").on("mousedown",function(){var e=v(this).attr("date");v(a.el).val(e).trigger("input").change(),v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),u=new Date(v(this).attr("data-date"))}).on("mouseup",function(){var i,t;0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide(),v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),a.options.format;v("#w2ui-overlay > div").html(a.getHourHTML()),v("#w2ui-overlay .w2ui-time").on("mousedown",function(e){v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),i=v(this).attr("hour"),u.setHours(i);var t=w2utils.formatDateTime(u,a.options.format);v(a.el).val(t).trigger("input").change()}),null==a.options.noMinutes||!1===a.options.noMinutes?v("#w2ui-overlay .w2ui-time").on("mouseup",function(){var e=v(this).attr("hour");0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide(),v(a.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),v("#w2ui-overlay > div").html(a.getMinHTML(e)),v("#w2ui-overlay .w2ui-time").on("mousedown",function(){v(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),t=v(this).attr("min"),u.setHours(i,t);var e=w2utils.formatDateTime(u,a.options.format);v(a.el).val(e).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):v("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}),v("#w2ui-overlay .previous").on("mousedown",function(){var e=a.options.current.split("/");e[0]=parseInt(e[0])-1,i(e[0],e[1])}),v("#w2ui-overlay .next").on("mousedown",function(){var e=a.options.current.split("/");e[0]=parseInt(e[0])+1,i(e[0],e[1])}),v("#w2ui-overlay .now").on("mousedown",function(){var e=w2utils.formatDateTime(new Date,a.options.format);return v(a.el).val(e).trigger("input").change(),!1}).on("mouseup",function(){setTimeout(function(){0<v("#w2ui-overlay").length&&v("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}(t,n)}-1!==["list","combo","enum"].indexOf(this.type)&&(s=this.el,d=this.el,"enum"===this.type&&(s=v(this.helpers.multi),d=v(s).find("input")),"list"===this.type&&(i=v(d).data("selected"),v.isPlainObject(i)&&!v.isEmptyObject(i)&&-1==r.index&&r.items.forEach(function(e,t){e.id===i.id&&(r.index=t)}),d=v(this.helpers.focus).find("input")),v(this.el).hasClass("has-focus"))&&(!1===r.openOnFocus&&""===v(d).val()&&!0!==a.tmp.force_open?v().w2overlay():a.tmp.force_hide?(v().w2overlay(),setTimeout(function(){delete a.tmp.force_hide},1)):(""!==v(d).val()&&delete a.tmp.force_open,t=w2utils.lang("No matches"),null!=r.url&&String(v(d).val()).length<r.minLength&&!0!==a.tmp.emptySet&&(t=r.minLength+" "+w2utils.lang("letters or more...")),null!=r.url&&""===v(d).val()&&!0!==a.tmp.emptySet&&(t=w2utils.lang(r.msgSearch||"Type to search...")),null==r.url&&0===r.items.length&&(t=w2utils.lang("Empty list")),null!=r.msgNoItems&&(n={search:v(d).val(),options:v.extend(!0,{},r)},r.url&&(n.remote={url:r.url,empty:!!a.tmp.emptySet,error:a.tmp.lastError,minLength:r.minLength}),t="function"==typeof r.msgNoItems?r.msgNoItems(n):r.msgNoItems),a.tmp.lastError&&(t=a.tmp.lastError),o=v.extend(!0,{},r,{search:!1,render:r.renderDrop,maxHeight:r.maxDropHeight,maxWidth:r.maxDropWidth,msgNoItems:t=t&&'<div style="white-space: normal; line-height: 1.3">'+t+"</div>",onSelect:function(i){var e,t,n;"enum"===a.type?(e=v(a.el).data("selected"),i.item&&!0!==(t=a.trigger({phase:"before",type:"add",target:a.el,originalEvent:i.originalEvent,item:i.item})).isCancelled&&(e.length>=r.max&&0<r.max&&e.pop(),delete i.item.hidden,e.push(i.item),v(a.el).data("selected",e).trigger("input").change(),v(a.helpers.multi).find("input").val("").width(20),a.refresh(),!0!==i.keepOpen?0<v("#w2ui-overlay").length&&v("#w2ui-overlay")[0].hide():(o.items.forEach(function(e,t){e.id==i.item.id&&(n=t)}),null!=n&&o.items.splice(n,1),o.selected=e,v(s).w2menu("refresh",o)),a.trigger(v.extend(t,{phase:"after"})))):(v(a.el).data("selected",i.item).val(i.item.text).trigger("input").change(),a.helpers.focus&&a.helpers.focus.find("input").val(""))}}),v(s).w2menu(e?"refresh-index":"refresh",o)))},inRange:function(e,t){var i,n,s,o=!1;if("date"===this.type){var a=w2utils.isDate(e,this.options.format,!0);if(a)if((!this.options.start&&!this.options.end||(c="string"==typeof this.options.start?this.options.start:v(this.options.start).val(),p="string"==typeof this.options.end?this.options.end:v(this.options.end).val(),d=w2utils.isDate(c,this.options.format,!0),u=w2utils.isDate(p,this.options.format,!0),h=new Date(a),u=u||h,(d=d||h)<=h&&h<=u))&&(o=!0),this.options.blocked&&-1!==v.inArray(e,this.options.blocked)&&(o=!1),null!==this.options.blockWeekDays&&void 0!==this.options.blockWeekDays&&null!=this.options.blockWeekDays.length)for(var r=this.options.blockWeekDays.length,l=0;l<r;l++)a.getDay()==this.options.blockWeekDays[l]&&(o=!1)}else if("time"===this.type)(!this.options.start&&!this.options.end||(i=this.toMin(e),n=this.toMin(this.options.start),s=(s=this.toMin(this.options.end))||i,(n=n||i)<=i&&i<=s))&&(o=!0);else if("datetime"===this.type){var d,u,c,p,h,a=w2utils.isDateTime(e,this.options.format,!0);if(a)if((o=!this.options.start&&!this.options.end||(h=a,d=(d="object"==typeof this.options.start&&this.options.start instanceof Date?this.options.start:""!==(c="string"==typeof this.options.start?this.options.start:v(this.options.start).val()).trim()?w2utils.isDateTime(c,this.options.format,!0):"")||h,u=(u="object"==typeof this.options.end&&this.options.end instanceof Date?this.options.end:""!==(p="string"==typeof this.options.end?this.options.end:v(this.options.end).val()).trim()?w2utils.isDateTime(p,this.options.format,!0):"")||h,t&&d instanceof Date&&(d.setHours(0),d.setMinutes(0),d.setSeconds(0)),d<=h&&h<=u)?!0:o)&&this.options.blocked)for(l=0;l<this.options.blocked.length;l++){var f=this.options.blocked[l];if("object"==typeof(f="string"==typeof f?w2utils.isDateTime(f,this.options.format,!0):f)&&f instanceof Date&&f.getFullYear()==a.getFullYear()&&f.getMonth()==a.getMonth()&&f.getDate()==a.getDate()){o=!1;break}}}return o},checkType:function(e,t){var i=this;switch(i.type){case"int":return t&&-1!==["-",i.options.groupSymbol].indexOf(e)?!0:w2utils.isInt(e.replace(i.options.numberRE,""));case"percent":e=e.replace(/%/g,"");case"float":return t&&-1!==["-",w2utils.settings.decimalSymbol,i.options.groupSymbol].indexOf(e)?!0:w2utils.isFloat(e.replace(i.options.numberRE,""));case"money":case"currency":return t&&-1!==["-",i.options.decimalSymbol,i.options.groupSymbol,i.options.currencyPrefix,i.options.currencySuffix].indexOf(e)?!0:w2utils.isFloat(e.replace(i.options.moneyRE,""));case"bin":return w2utils.isBin(e);case"hex":return w2utils.isHex(e);case"alphanumeric":return w2utils.isAlphaNumeric(e)}return!0},addPrefix:function(){var i=this;setTimeout(function(){var e;"clear"!==i.type&&((e=v(i.el).data("tmp")||{})["old-padding-left"]&&v(i.el).css("padding-left",e["old-padding-left"]),e["old-padding-left"]=v(i.el).css("padding-left"),v(i.el).data("tmp",e),i.helpers.prefix&&v(i.helpers.prefix).remove(),""!==i.options.prefix)&&(v(i.el).before('<div class="w2ui-field-helper">'+i.options.prefix+"</div>"),(e=v(i.el).prev()).css({color:v(i.el).css("color"),"font-family":v(i.el).css("font-family"),"font-size":v(i.el).css("font-size"),"padding-top":v(i.el).css("padding-top"),"padding-bottom":v(i.el).css("padding-bottom"),"padding-left":v(i.el).css("padding-left"),"padding-right":0,"margin-top":parseInt(v(i.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(v(i.el).css("margin-bottom"),10)+1+"px","margin-left":v(i.el).css("margin-left"),"margin-right":0}).on("click",function(e){var t;i.options.icon&&"function"==typeof i.onIconClick?!0!==(t=i.trigger({phase:"before",type:"iconClick",target:i.el,el:v(this).find("span.w2ui-icon")[0]})).isCancelled&&i.trigger(v.extend(t,{phase:"after"})):("list"===i.type?v(i.helpers.focus).find("input"):v(i.el)).focus()}),v(i.el).css("padding-left",e.width()+parseInt(v(i.el).css("padding-left"),10)+"px"),i.helpers.prefix=e)},1)},addSuffix:function(){var t,i,s=this;setTimeout(function(){var e;"clear"!==s.type&&((e=v(s.el).data("tmp")||{})["old-padding-right"]&&v(s.el).css("padding-right",e["old-padding-right"]),e["old-padding-right"]=v(s.el).css("padding-right"),v(s.el).data("tmp",e),i=parseInt(v(s.el).css("padding-right"),10),s.options.arrows&&(s.helpers.arrows&&v(s.helpers.arrows).remove(),v(s.el).after('<div class="w2ui-field-helper" style="border: 1px solid transparent">&#160;    <div class="w2ui-field-up" type="up">        <div class="arrow-up" type="up"></div>    </div>    <div class="w2ui-field-down" type="down">        <div class="arrow-down" type="down"></div>    </div></div>'),(t=v(s.el).next()).css({color:v(s.el).css("color"),"font-family":v(s.el).css("font-family"),"font-size":v(s.el).css("font-size"),height:v(s.el).height()+parseInt(v(s.el).css("padding-top"),10)+parseInt(v(s.el).css("padding-bottom"),10)+"px",padding:0,"margin-top":parseInt(v(s.el).css("margin-top"),10)+1+"px","margin-bottom":0,"border-left":"1px solid silver"}).css("margin-left","-"+(t.width()+parseInt(v(s.el).css("margin-right"),10)+12)+"px").on("mousedown",function(t){var i=v("body");function n(e){v(s.el).focus(),s.keyDown(v.Event("keydown"),{keyCode:"up"===v(t.target).attr("type")?38:40}),!1!==e&&v("body").data("_field_update_timer",setTimeout(n,60))}i.on("mouseup",function e(){clearTimeout(i.data("_field_update_timer"));i.off("mouseup",e)}),i.data("_field_update_timer",setTimeout(n,700)),n(!1)}),i+=t.width()+12,v(s.el).css("padding-right",i+"px"),s.helpers.arrows=t),""!==s.options.suffix)&&(s.helpers.suffix&&v(s.helpers.suffix).remove(),v(s.el).after('<div class="w2ui-field-helper">'+s.options.suffix+"</div>"),(t=v(s.el).next()).css({color:v(s.el).css("color"),"font-family":v(s.el).css("font-family"),"font-size":v(s.el).css("font-size"),"padding-top":v(s.el).css("padding-top"),"padding-bottom":v(s.el).css("padding-bottom"),"padding-left":"3px","padding-right":v(s.el).css("padding-right"),"margin-top":parseInt(v(s.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(v(s.el).css("margin-bottom"),10)+1+"px"}).on("click",function(e){("list"===s.type?v(s.helpers.focus).find("input"):v(s.el)).focus()}),t.css("margin-left","-"+(w2utils.getSize(t,"width")+parseInt(v(s.el).css("margin-right"),10)+2)+"px"),i+=t.width()+3,v(s.el).css("padding-right",i+"px"),s.helpers.suffix=t)},1)},addFocus:function(){var i,n=this,e=(this.options,v(n.helpers.focus).remove(),parseInt(v(n.el).attr("tabIndex"))),t=(isNaN(e)||-1===e||(n.el._tabIndex=e),null==(e=n.el._tabIndex?n.el._tabIndex:e)&&(e=-1),isNaN(e)&&(e=0),""),t='<div class="w2ui-field-helper">    <div class="w2ui-icon icon-search" style="opacity: 0; display: none"></div>    <input '+(t=null!=v(n.el).attr("id")?'id="'+v(n.el).attr("id")+'_search"':t)+' type="text" tabIndex="'+e+'" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false"/></div>',e=(v(n.el).attr("tabindex",-1).before(t),v(n.el).prev());(n.helpers.focus=e).css({width:v(n.el).width(),"margin-top":v(n.el).css("margin-top"),"margin-left":parseInt(v(n.el).css("margin-left"))+parseInt(v(n.el).css("padding-left"))+"px","margin-bottom":v(n.el).css("margin-bottom"),"margin-right":v(n.el).css("margin-right")}).find("input").css({cursor:"default",width:"100%",outline:"none",opacity:1,margin:0,border:"1px solid transparent",padding:v(n.el).css("padding-top"),"padding-left":0,"margin-left":0,"background-color":"transparent"}),e.find("input").on("click",function(e){0===v("#w2ui-overlay").length&&n.focus(e),e.stopPropagation()}).on("focus",function(e){i=v(n.el).attr("placeholder"),v(n.el).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"}),v(this).val(""),v(n.el).triggerHandler("focus"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("blur",function(e){v(n.el).css("outline","none"),v(this).val(""),n.refresh(),v(n.el).triggerHandler("blur"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,null!=i&&v(n.el).attr("placeholder",i)}).on("keydown",function(e){var t=this;n.keyDown(e),setTimeout(function(){""===t.value?v(n.el).attr("placeholder",i):v(n.el).attr("placeholder","")},10)}).on("keyup",function(e){n.keyUp(e)}).on("keypress",function(e){n.keyPress(e)}),e.on("click",function(e){v(this).find("input").focus()}),n.refresh()},addMulti:function(){var s=this,e=(this.options,v(s.helpers.multi).remove(),""),t="margin-top     : 0px; margin-bottom  : 0px; margin-left    : "+v(s.el).css("margin-left")+"; margin-right   : "+v(s.el).css("margin-right")+"; width          : "+(w2utils.getSize(s.el,"width")-parseInt(v(s.el).css("margin-left"),10)-parseInt(v(s.el).css("margin-right"),10))+"px;",i="",n=(null!=v(s.el).attr("id")&&(i='id="'+v(s.el).attr("id")+'_search" '),"enum"===s.type&&((n=v(s.el).attr("tabIndex"))&&-1!==n&&(s.el._tabIndex=n),null==(n=s.el._tabIndex?s.el._tabIndex:n)&&(n=0),e='<div class="w2ui-field-helper w2ui-list" style="'+t+'; box-sizing: border-box">    <div style="padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">    <ul>        <li style="padding-left: 0px; padding-right: 0px" class="nomouse">            <input '+i+' type="text" style="width: 20px; margin: -3px 0 0; padding: 2px 0; border-color: white" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false"'+(v(s.el).prop("readonly")?' readonly="readonly"':"")+(v(s.el).prop("disabled")?' disabled="disabled"':"")+' tabindex="'+n+'"/>        </li>    </ul>    </div></div>'),"file"===s.type&&(e='<div class="w2ui-field-helper w2ui-list" style="'+t+'; box-sizing: border-box">   <div style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;">       <input '+i+' name="attachment" class="file-input" type="file" style="width: 100%; height: 100%; opacity: 0;" tabindex="-1"'+(1!==s.options.max?' multiple="multiple"':"")+(v(s.el).prop("readonly")?' readonly="readonly"':"")+(v(s.el).prop("disabled")?' disabled="disabled"':"")+(v(s.el).attr("accept")?' accept="'+v(s.el).attr("accept")+'"':"")+'/>   </div>    <div style="position: absolute; padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">        <ul><li style="padding-left: 0px; padding-right: 0px" class="nomouse"></li></ul>    </div></div>'),v(s.el).data("tmp")||{}),o=(n["old-background-color"]=v(s.el).css("background-color"),n["old-border-color"]=v(s.el).css("border-color"),v(s.el).data("tmp",n),v(s.el).before(e).css({"background-color":"transparent","border-color":"transparent"}),v(s.el).prev());s.helpers.multi=o,"enum"===s.type&&(v(s.el).attr("tabindex",-1),o.find("input").on("click",function(e){0===v("#w2ui-overlay").length&&s.focus(e),v(s.el).triggerHandler("click")}).on("focus",function(e){v(o).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"}),v(s.el).triggerHandler("focus"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("blur",function(e){v(o).css("outline","none"),v(s.el).triggerHandler("blur"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("keyup",function(e){s.keyUp(e)}).on("keydown",function(e){s.keyDown(e)}).on("keypress",function(e){s.keyPress(e)}),o.on("click",function(e){v(this).find("input").focus()})),"file"===s.type&&(v(s.el).css("outline","none"),o.find("input").off(".drag").on("click.drag",function(e){e.stopPropagation(),v(s.el).prop("readonly")||v(s.el).prop("disabled")||v(s.el).focus()}).on("dragenter.drag",function(e){v(s.el).prop("readonly")||v(s.el).prop("disabled")||v(o).addClass("w2ui-file-dragover")}).on("dragleave.drag",function(e){v(s.el).prop("readonly")||v(s.el).prop("disabled")||v(o).removeClass("w2ui-file-dragover")}).on("drop.drag",function(e){if(!v(s.el).prop("readonly")&&!v(s.el).prop("disabled")){v(o).removeClass("w2ui-file-dragover");for(var t=e.originalEvent.dataTransfer.files,i=0,n=t.length;i<n;i++)s.addFile.call(s,t[i]);v(s.el).focus(),e.preventDefault(),e.stopPropagation()}}).on("dragover.drag",function(e){e.preventDefault(),e.stopPropagation()}).on("change.drag",function(){if(v(s.el).focus(),void 0!==this.files)for(var e=0,t=this.files.length;e<t;e++)s.addFile.call(s,this.files[e])})),s.refresh()},addFile:function(e){var i=this,t=this.options,n=v(i.el).data("selected"),s={name:e.name,type:e.type,modified:e.lastModifiedDate,size:e.size,content:null,file:e},o=0,a=0;if(n)for(var r=0;r<n.length;r++){if(n[r].name==e.name&&n[r].size==e.size)return;o+=n[r].size,a++}var l,d=i.trigger({phase:"before",type:"add",target:i.el,file:s,total:a,totalSize:o});!0!==d.isCancelled&&(0!==t.maxFileSize&&s.size>t.maxFileSize?(l="Maximum file size is "+w2utils.formatSize(t.maxFileSize),!1===t.silent&&v(i.el).w2tag(l),console.log("ERROR: "+l)):0!==t.maxSize&&o+s.size>t.maxSize?(l=w2utils.lang("Maximum total size is")+" "+w2utils.formatSize(t.maxSize),!1===t.silent?v(i.el).w2tag(l):console.log("ERROR: "+l)):0!==t.max&&a>=t.max?(l=w2utils.lang("Maximum number of files is")+" "+t.max,!1===t.silent?v(i.el).w2tag(l):console.log("ERROR: "+l)):(n.push(s),"undefined"!=typeof FileReader&&!0===t.readContent?((l=new FileReader).onload=function(e){var e=e.target.result,t=e.indexOf(",");s.content=e.substr(t+1),i.refresh(),v(i.el).trigger("input").trigger("change"),i.trigger(v.extend(d,{phase:"after"}))},l.readAsDataURL(e)):(i.refresh(),v(i.el).trigger("input").trigger("change"),i.trigger(v.extend(d,{phase:"after"})))))},normMenu:function(e,t){if(v.isArray(e)){for(var i=0;i<e.length;i++)"string"==typeof e[i]?e[i]={id:e[i],text:e[i]}:null!=e[i]?(null!=e[i].text&&null==e[i].id&&(e[i].id=e[i].text),null==e[i].text&&null!=e[i].id&&(e[i].text=e[i].id),null!=e[i].caption&&(e[i].text=e[i].caption)):e[i]={id:null,text:"null"};return e}if("function"==typeof e)return w2obj.field.prototype.normMenu.call(this,e.call(this,t));if("object"==typeof e){var n=[];for(i in e)n.push({id:i,text:e[i]});return n}},getMonthHTML:function(e,t,i){for(var n=new Date,s=w2utils.settings.fullmonths,o=["31","28","31","30","31","30","31","31","30","31","30","31"],a=n.getFullYear()+"/"+(Number(n.getMonth())+1)+"/"+n.getDate(),r=w2utils.settings.fulldays.slice(),l=w2utils.settings.shortdays.slice(),d=("M"!==w2utils.settings.weekStarts&&(r.unshift(r.pop()),l.unshift(l.pop())),this.options),u=(null==d&&(d={}),t=w2utils.isInt(t)?parseInt(t):n.getFullYear(),12<(e=w2utils.isInt(e)?parseInt(e):n.getMonth()+1)&&(e-=12,t++),(e<1||0===e)&&(e+=12,t--),t/4==Math.floor(t/4)?o[1]="29":o[1]="28",d.current=e+"/"+t,(n=new Date(t,e-1,1)).getDay()),c="",p=0;p<l.length;p++)c+='<td title="'+r[p]+'">'+l[p]+"</td>";var h='<div class="w2ui-calendar-title title">    <div class="w2ui-calendar-previous previous"> <div></div> </div>    <div class="w2ui-calendar-next next"> <div></div> </div> '+s[e-1]+", "+t+'</div><table class="w2ui-calendar-days" cellspacing="0"><tbody>    <tr class="w2ui-day-title">'+c+"</tr>    <tr>",f=1;"M"!==w2utils.settings.weekStarts&&u++,"datetime"===this.type&&(n=w2utils.isDateTime(i,d.format,!0),i=w2utils.formatDate(n,w2utils.settings.dateFormat));for(var m=1;m<43;m++){if(0===u&&1==m){for(var g=0;g<6;g++)h+='<td class="w2ui-day-empty">&#160;</td>';m+=6}else if(m<u||o[e-1]<f){h+='<td class="w2ui-day-empty">&#160;</td>',m%7==0&&(h+="</tr><tr>");continue}var w,y,v=t+"/"+e+"/"+f,x=new Date(v),b="",k=(6===x.getDay()&&(b=" w2ui-saturday"),0===x.getDay()&&(b=" w2ui-sunday"),v==a&&(b+=" w2ui-today"),f),T="",C="",v="datetime"===this.type?(w=w2utils.formatDateTime(v,d.format),w2utils.formatDate(v,w2utils.settings.dateFormat)):w=w2utils.formatDate(v,d.format);d.colored&&void 0!==d.colored[v]&&(C="background-color: "+(y=d.colored[v].split(":"))[0]+";",T="color: "+y[1]+";"),h+='<td class="'+(this.inRange(w,!0)?"w2ui-date "+(v==i?"w2ui-date-selected":""):"w2ui-blocked")+b+'"    style="'+T+C+'" date="'+w+'" data-date="'+x+'">'+k+"</td>",(m%7==0||0===u&&1==m)&&(h+="</tr><tr>"),f++}return h+="</tr></tbody></table>"},getYearHTML:function(){for(var e=w2utils.settings.shortmonths,t=w2utils.settings.dateStartYear,i=w2utils.settings.dateEndYear,n="",s="",o=0;o<e.length;o++)n+='<div class="w2ui-jump-month" name="'+o+'">'+e[o]+"</div>";for(var a=t;a<=i;a++)s+='<div class="w2ui-jump-year" name="'+a+'">'+a+"</div>";return'<div id="w2ui-jump-month">'+n+'</div><div id="w2ui-jump-year">'+s+"</div>"},getHourHTML:function(){for(var e=[],t=this.options,i=-1<(t=null==t?{format:w2utils.settings.timeFormat}:t).format.indexOf("h24"),n=0;n<24;n++){var s,o,a=12!=n||i?(12<=n&&!i?n-12:n)+":00"+(i?"":n<12?" am":" pm"):"12:00 pm",r=(e[Math.floor(n/8)]||(e[Math.floor(n/8)]=""),this.fromMin(this.toMin(a))),l=this.fromMin(this.toMin(a)+59);"datetime"===this.type&&(s=w2utils.isDateTime(this.el.value,t.format,!0),o=t.format.split("|")[0].trim(),r=w2utils.formatDate(s,o)+" "+r,l=w2utils.formatDate(s,o)+" "+l),e[Math.floor(n/8)]+='<div class="'+(this.inRange(r)||this.inRange(l)?"w2ui-time ":"w2ui-blocked")+'" hour="'+n+'">'+a+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Hour")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+e[0]+"</td>       <td>"+e[1]+"</td>       <td>"+e[2]+"</td>   </tr></tbody></table></div></div>"},getMinHTML:function(e){null==e&&(e=0);for(var t=this.options,i=-1<(t=null==t?{format:w2utils.settings.timeFormat}:t).format.indexOf("h24"),n=[],s=0;s<60;s+=5){var o,a,r=(12<e&&!i?e-12:e)+":"+(s<10?0:"")+s+" "+(i?"":e<12?"am":"pm"),l=r,d=s<20?0:s<40?1:2;n[d]||(n[d]=""),"datetime"===this.type&&(o=w2utils.isDateTime(this.el.value,t.format,!0),a=t.format.split("|")[0].trim(),l=w2utils.formatDate(o,a)+" "+l),n[d]+='<div class="'+(this.inRange(l)?"w2ui-time ":"w2ui-blocked")+'" min="'+s+'">'+r+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Minute")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+n[0]+"</td>       <td>"+n[1]+"</td>       <td>"+n[2]+"</td>   </tr></tbody></table></div></div>"},toMin:function(e){var t;return"string"!=typeof e||2!==(t=e.split(":")).length?null:(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),-1!==e.indexOf("pm")&&12!==t[0]&&(t[0]+=12),60*t[0]+t[1])},fromMin:function(e){1440<=e&&(e%=1440),e<0&&(e=1440+e);var t=Math.floor(e/60),e=(e%60<10?"0":"")+e%60,i=this.options;return-1!==(i=null==i?{format:w2utils.settings.timeFormat}:i).format.indexOf("h24")?t+":"+e:(t<=12?t:t-12)+":"+e+" "+(12<=t?"pm":"am")}},w2utils.event),w2obj.field=s}(jQuery);